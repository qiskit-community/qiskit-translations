


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ja-JP" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ja-JP" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>教科書的なアルゴリズムと Shor のアルゴリズム &mdash; Qiskit 0.26.1 ドキュメント</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme-override.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-variables.ade9f9d55df9d2893fc676ecd59723a1.css" type="text/css" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="../../getting_started.html">Getting started</a>
          </li>

          <li>
            <a href="../../tutorials.html">Tutorials</a>
          </li>

          <li>
            <a href="https://qiskit.org/documentation/partners/" target="_blank">Providers</a>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Applications
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/machine-learning/">
                  <span class="dropdown-title">Machine learning</span>
                  <p>QSVM, VQC (Variational Quantum Classifier), and QGAN (Quantum Generative
                    Adversarial Network) algorithms.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/nature/">
                  <span class="dropdown-title">Nature</span>
                  <p>Quantum applications in chemistry, physics, and biology.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/finance/">
                  <span class="dropdown-title">Finance</span>
                  <p>Uncertainty components for stock/securities problems, Ising translators for
                    portfolio optimizations and data providers to source real or random data.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/optimization/">
                  <span class="dropdown-title">Optimization</span>
                  <p>High-level optimization problems that are ready to
                    run on simulators and real quantum devices</p>
                </a>
              </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.slack.com">
                  <span class="dropdown-title">Slack support</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.org/textbook">
                  <span class="dropdown-title">Qiskit Textbook</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.org/events">
                  <span class="dropdown-title">Qiskit events</span>
                  <p></p>
                </a>
            </div>
          </li>
          <li>
            <a href="https://github.com/Qiskit/" target="_blank">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="rst-current-version-label">Japanese</span>
    <span class="rst-versions-dropdown-icon"></span>
  </span>
  <div class="rst-other-versions">
    
    <dl>
      <dt>言語</dt>
      
        <dd><a class="version" href="/documentation/tutorials/algorithms/09_textbook_algorithms.html">English</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ja_JP/tutorials/algorithms/09_textbook_algorithms.html">Japanese</a></dd>
      
        <dd><a class="version" href="/documentation/locale/de_DE/tutorials/algorithms/09_textbook_algorithms.html">German</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ko_KR/tutorials/algorithms/09_textbook_algorithms.html">Korean</a></dd>
      
        <dd><a class="version" href="/documentation/locale/pt_BR/tutorials/algorithms/09_textbook_algorithms.html">Portuguese, Brazilian</a></dd>
      
        <dd><a class="version" href="/documentation/locale/fr_FR/tutorials/algorithms/09_textbook_algorithms.html">French</a></dd>
      
    </dl>
    
  </div>
  <script>
    jQuery('.version').click((evt) => {
      const hash = window.location.hash
      const complete_url = evt.target.href + hash
      window.location = complete_url
      evt.preventDefault()
    })
  </script>
</div>

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">ドキュメントのホームページ</a></li>
</ul>
<p><span class="caption-text">Frontmatter</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../qc_intro.html">量子コンピューティングの概要</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro_tutorial1.html">Qiskit 入門</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">リリースノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing_to_qiskit.html">Qiskit に貢献する</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">ローカル構成</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">よくある質問</a></li>
</ul>
<p><span class="caption-text">ライブラリ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/circuit_library.html">サーキット・ライブラリ</a></li>
</ul>
<p><span class="caption-text">API リファレンス</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/terra.html">Qiskit (Terra)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/aer.html">Qiskit シミュレーター (Aer)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ignis.html">Qiskit Experiments (Ignis)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/aqua.html">Qiskit アプリケーション モジュール (Aqua)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ibmq-provider.html">Qiskit IBM Quantum (Provider)</a></li>
</ul>
<p><span class="caption-text">Qiskit アプリケーション (Aqua) マイグレーション ガイド</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../aqua_migration.html">Qiskit アプリケーション (Aqua) マイグレーション ガイド</a></li>
</ul>
<p><span class="caption-text">トラブルシューティング</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://quantum-computing.ibm.com/docs/cloud/errors">IBM Quantum API エラー・コード</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>教科書的なアルゴリズムと Shor のアルゴリズム</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/algorithms/09_textbook_algorithms.ipynb" rel="nofollow"><img src="../../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">
          
          <div class="rst-content style-external-links">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>このページは <a href="#id2"><span class="problematic" id="id3">`tutorials/algorithms/09_textbook_algorithms.ipynb`__</span></a> から生成されました。</p>
<p><a class="reference external" href="https://quantum-computing.ibm.com/jupyter/tutorial/algorithms/09_textbook_algorithms.ipynb">IBM Quantum lab</a> でインタラクティブに実行します。</p>
</div>
<section id="教科書的なアルゴリズムと-Shor-のアルゴリズム">
<h1>教科書的なアルゴリズムと Shor のアルゴリズム<a class="headerlink" href="#教科書的なアルゴリズムと-Shor-のアルゴリズム" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>Qiskit には <a class="reference external" href="https://qiskit.org/textbook/ch-algorithms/deutsch-jozsa.html">Deutsch-Jozsa のアルゴリズム</a>, <a class="reference external" href="https://qiskit.org/textbook/ch-algorithms/bernstein-vazirani.html">Bernstein-Vazirani のアルゴリズム</a>, <a class="reference external" href="https://qiskit.org/textbook/ch-algorithms/simon.html">Simon のアルゴリズム</a> などの、よく知られている教科書的な量子アルゴリズムの実装が含まれています。</p>
<p>Qiskit には <a class="reference external" href="https://qiskit.org/textbook/ch-algorithms/shor.html">Shor のアルゴリズム</a> の実装があります。</p>
<p>上記の参照先では回路の配置と詳細な説明を行っていますが、このノートブックでは Qiskit であらかじめ構築されたアルゴリズムの例を示しているので、実験や教育の目的で用いることができます。</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">BasicAer</span>
<span class="kn">from</span> <span class="nn">qiskit.aqua</span> <span class="kn">import</span> <span class="n">QuantumInstance</span>
<span class="kn">from</span> <span class="nn">qiskit.aqua.algorithms</span> <span class="kn">import</span> <span class="n">BernsteinVazirani</span><span class="p">,</span> <span class="n">DeutschJozsa</span><span class="p">,</span> <span class="n">Simon</span><span class="p">,</span> <span class="n">Shor</span>
<span class="kn">from</span> <span class="nn">qiskit.aqua.components.oracles</span> <span class="kn">import</span> <span class="n">TruthTableOracle</span>
</pre></div>
</div>
</div>
<section id="Deutsch-Jozsa-のアルゴリズム">
<h2>Deutsch-Jozsa のアルゴリズム<a class="headerlink" href="#Deutsch-Jozsa-のアルゴリズム" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>まず <a class="reference external" href="https://qiskit.org/documentation/stubs/qiskit.aqua.algorithms.DeutschJozsa.html">Deutsch-Jozsa のアルゴリズム</a> から始めてみましょう。これは関数が入力として与えられたときに、その関数が <code class="docutils literal notranslate"><span class="pre">balanced</span></code> なのか <code class="docutils literal notranslate"><span class="pre">constant</span></code> なのかの判定ができるものとなっています。 Qiskit では、真理値表から作成したオラクルを用いてその実験を行うことが可能です。例えば以下のように、 <code class="docutils literal notranslate"><span class="pre">TruthTableOracle</span></code> インスタンスを作成することができます。</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bitstr</span> <span class="o">=</span> <span class="s1">&#39;11110000&#39;</span>
<span class="n">oracle</span> <span class="o">=</span> <span class="n">TruthTableOracle</span><span class="p">(</span><span class="n">bitstr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>このように、真理値表は表内の全てのエントリーの値を含む <code class="docutils literal notranslate"><span class="pre">bitstr</span></code> で指定されます。長さは <span class="math notranslate nohighlight">\(8\)</span> となっているので、対応する真理値表は <span class="math notranslate nohighlight">\(3\)</span> ビットの入力から構成されています。もちろんこの真理値表は、値の半分が <span class="math notranslate nohighlight">\(1\)</span> 、 残りの半分は <span class="math notranslate nohighlight">\(0\)</span> であることから、 <code class="docutils literal notranslate"><span class="pre">balanced</span></code> 関数を表していることがわかります。</p>
<p>It might seem like a moot point running Deutsch-Jozsa on a truthtable as the function outputs are literally listed as the truthtable’s values. The intention is to create an oracle circuit whose groundtruth information is readily available to us but obviously not to the quantum Deutsch-Jozsa algorithm that is to act upon the oracle circuit. In more realistic situations, the oracle circuit would be provided as a blackbox to the algorithm.</p>
<p><code class="docutils literal notranslate"><span class="pre">TruthTableOracle</span></code> インスタンスでエンコードされた関数に対応する回路を調べることができます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">oracle</span><span class="o">.</span><span class="n">circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_algorithms_09_textbook_algorithms_5_0.png" src="../../_images/tutorials_algorithms_09_textbook_algorithms_5_0.png" />
</div>
</div>
<p>見ての通り、 <span class="math notranslate nohighlight">\(v_i\)</span> は三つの入力ビットに、 <span class="math notranslate nohighlight">\(o_0\)</span> はオラクルの出力ビットに、 <span class="math notranslate nohighlight">\(a_0\)</span> は補助ビットにそれぞれ対応しています。</p>
<p>次に、オラクルを用いて <code class="docutils literal notranslate"><span class="pre">DeutschJozsa</span></code> インスタンスを作成し、実行して結果を確認します。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dj</span> <span class="o">=</span> <span class="n">DeutschJozsa</span><span class="p">(</span><span class="n">oracle</span><span class="p">)</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">BasicAer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">QuantumInstance</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1024</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The truth table </span><span class="si">{</span><span class="n">bitstr</span><span class="si">}</span><span class="s1"> represents a </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1"> function.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The truth table 11110000 represents a &#39;balanced&#39; function.
</pre></div></div>
</div>
<p>もちろん、以下のように定数関数の例を用意することもできます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bitstr</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span> <span class="o">*</span> <span class="mi">16</span>
<span class="n">oracle</span> <span class="o">=</span> <span class="n">TruthTableOracle</span><span class="p">(</span><span class="n">bitstr</span><span class="p">)</span>
<span class="n">dj</span> <span class="o">=</span> <span class="n">DeutschJozsa</span><span class="p">(</span><span class="n">oracle</span><span class="p">)</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">BasicAer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">QuantumInstance</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1024</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The truth table </span><span class="si">{</span><span class="n">bitstr</span><span class="si">}</span><span class="s1"> represents a </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1"> function.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The truth table 1111111111111111 represents a &#39;constant&#39; function.
</pre></div></div>
</div>
</section>
<section id="Bernstein-Vazirani-のアルゴリズム">
<h2>Bernstein-Vazirani のアルゴリズム<a class="headerlink" href="#Bernstein-Vazirani-のアルゴリズム" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>次に <a href="#id2"><span class="problematic" id="id4">`Bernstein-Vazirani のアルゴリズム&lt;https://qiskit.org/documentation/stubs/qiskit.aqua.algorithms.BernsteinVazirani.html&gt;`__</span></a> を用いて、隠された文字列の発見を試みます。ここでも例のために TruthTableOracle インスタンスを作成します。</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bitstr</span> <span class="o">=</span> <span class="s1">&#39;00111100&#39;</span>
<span class="n">oracle</span> <span class="o">=</span> <span class="n">TruthTableOracle</span><span class="p">(</span><span class="n">bitstr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>このように、真理値表は表内の全てのエントリーの値を含む <code class="docutils literal notranslate"><span class="pre">bitstr</span></code> で指定されます。長さは <span class="math notranslate nohighlight">\(8\)</span> となっているので、対応する真理値表は <span class="math notranslate nohighlight">\(3\)</span> ビットの入力から構成されています。真理値表は以下のように関数のマッピングを表しています。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{a} \cdot 000 \mod 2 = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{a} \cdot 001 \mod 2 = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{a} \cdot 010 \mod 2 = 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{a} \cdot 011 \mod 2 = 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{a} \cdot 100 \mod 2 = 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{a} \cdot 101 \mod 2 = 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{a} \cdot 110 \mod 2 = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{a} \cdot 111 \mod 2 = 0\)</span></p></li>
</ul>
<p>目標は、全ての内積方程式を満たすビット列 <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> を見つけることです。</p>
<p>もう一度 <code class="docutils literal notranslate"><span class="pre">TruthTableOracle</span></code> インスタンスでエンコードされたバイナリ関数に対応するオラクル回路を見てみましょう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">oracle</span><span class="o">.</span><span class="n">circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_algorithms_09_textbook_algorithms_13_0.png" src="../../_images/tutorials_algorithms_09_textbook_algorithms_13_0.png" />
</div>
</div>
<p>ここでも <span class="math notranslate nohighlight">\(v_i\)</span> は三つの入力ビットに、 <span class="math notranslate nohighlight">\(o_0\)</span> はオラクルの出力ビットに、 <span class="math notranslate nohighlight">\(a_0\)</span> は補助ビットにそれぞれ対応しています。</p>
<p>まず 正解 <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> を古典的に計算してみましょう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a_bitstr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">num_bits</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bitstr</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)):</span>
    <span class="n">bit</span> <span class="o">=</span> <span class="n">bitstr</span><span class="p">[</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">]</span>
    <span class="n">a_bitstr</span> <span class="o">+=</span> <span class="n">bit</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The groundtruth result bitstring is </span><span class="si">{</span><span class="n">a_bitstr</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The groundtruth result bitstring is 110.
</pre></div></div>
</div>
<p>次に、オラクルを使って <code class="docutils literal notranslate"><span class="pre">BernsteinVazirani</span></code> インスタンスを作成し、それを実行して結果を正解と照合します。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bv</span> <span class="o">=</span> <span class="n">BernsteinVazirani</span><span class="p">(</span><span class="n">oracle</span><span class="p">)</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">BasicAer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">bv</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">QuantumInstance</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1024</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The result bitstring computed using Bernstein-Vazirani is </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
<span class="k">assert</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">a_bitstr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The result bitstring computed using Bernstein-Vazirani is 110.
</pre></div></div>
</div>
</section>
<section id="Simon-のアルゴリズム">
<h2>Simon のアルゴリズム<a class="headerlink" href="#Simon-のアルゴリズム" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><a class="reference external" href="https://qiskit.org/documentation/stubs/qiskit.aqua.algorithms.Simon.html">Simon のアルゴリズム</a> によって、 <a class="reference external" href="https://en.wikipedia.org/wiki/Simon's_problem">Simon の問題</a> を解いてみましょう。改めて例のために TruthTableOracle インスタンスを作成していますが、ここでの構造は異なる形式を取っています。</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bitmaps</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;01101001&#39;</span><span class="p">,</span>
    <span class="s1">&#39;10011001&#39;</span><span class="p">,</span>
    <span class="s1">&#39;01100110&#39;</span>
<span class="p">]</span>
<span class="n">oracle</span> <span class="o">=</span> <span class="n">TruthTableOracle</span><span class="p">(</span><span class="n">bitmaps</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>このように、真理値表は長さ 8 のビット列 3 つによって指定されており、それぞれが表の出力列に対する全てのエントリーの値を含んでいます。各ビット列の長さは <span class="math notranslate nohighlight">\(8\)</span> なので、真理値表は <span class="math notranslate nohighlight">\(3\)</span> ビットの入力をもちます。また <span class="math notranslate nohighlight">\(3\)</span> つのビット列があるので、真理値表は <span class="math notranslate nohighlight">\(3\)</span> ビットの出力をもちます。</p>
<p>真理値で表される関数 <span class="math notranslate nohighlight">\(f\)</span> は、1 対 1 か 2 対 1 のどちらかであることが保証されています。我々の目的は、そのどちらであるかを決定することです。 2 対 1 の場合には、 <span class="math notranslate nohighlight">\(\forall \mathbf{x},\mathbf{y}\)</span>: <span class="math notranslate nohighlight">\(\mathbf{x} \oplus \mathbf{y} = \mathbf{s}\)</span> iff <span class="math notranslate nohighlight">\(f(\mathbf{x}) = f(\mathbf{y})\)</span> を満たすマスク <span class="math notranslate nohighlight">\(\mathbf{s}\)</span> を計算する必要があります。 <span class="math notranslate nohighlight">\(f\)</span> が 1 対 1 ならば、明らかに対応するマスクは <span class="math notranslate nohighlight">\(\mathbf{s} = \mathbf{0}\)</span> となります。</p>
<p>まず 正解のマスク <span class="math notranslate nohighlight">\(\mathbf{s}\)</span> を古典的に計算してみましょう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">compute_mask</span><span class="p">(</span><span class="n">input_bitmaps</span><span class="p">):</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">input_bitmaps</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">def</span> <span class="nf">find_pair</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">vals</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

    <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span> <span class="o">=</span> <span class="n">find_pair</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">binary_repr</span><span class="p">(</span><span class="n">k1</span> <span class="o">^</span> <span class="n">k2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_bitmaps</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>

<span class="n">mask</span> <span class="o">=</span> <span class="n">compute_mask</span><span class="p">(</span><span class="n">bitmaps</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The groundtruth mask is </span><span class="si">{</span><span class="n">mask</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The groundtruth mask is 011.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">simon</span> <span class="o">=</span> <span class="n">Simon</span><span class="p">(</span><span class="n">oracle</span><span class="p">)</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">BasicAer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simon</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">QuantumInstance</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1024</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The mask computed using Simon is </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
<span class="k">assert</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The mask computed using Simon is 011.
</pre></div></div>
</div>
<p>また 1 対 1 関数を表す真理値表 (対応するマスクは <span class="math notranslate nohighlight">\(\mathbf{0}\)</span> ) は、以下のように手軽に試すこともできます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bitmaps</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;00011110&#39;</span><span class="p">,</span>
    <span class="s1">&#39;01100110&#39;</span><span class="p">,</span>
    <span class="s1">&#39;10101010&#39;</span>
<span class="p">]</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">compute_mask</span><span class="p">(</span><span class="n">bitmaps</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The groundtruth mask is </span><span class="si">{</span><span class="n">mask</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

<span class="n">oracle</span> <span class="o">=</span> <span class="n">TruthTableOracle</span><span class="p">(</span><span class="n">bitmaps</span><span class="p">)</span>
<span class="n">simon</span> <span class="o">=</span> <span class="n">Simon</span><span class="p">(</span><span class="n">oracle</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simon</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">QuantumInstance</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1024</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The mask computed using Simon is </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
<span class="k">assert</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The groundtruth mask is 000.
The mask computed using Simon is 000.
</pre></div></div>
</div>
</section>
<section id="Shor-の素因数分解アルゴリズム">
<h2>Shor の素因数分解アルゴリズム<a class="headerlink" href="#Shor-の素因数分解アルゴリズム" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><a class="reference external" href="https://qiskit.org/documentation/stubs/qiskit.aqua.algorithms.Shor.html">Shor の素因数分解アルゴリズム</a> は最もよく知られた量子アルゴリズムの一つであり、入力された整数 <span class="math notranslate nohighlight">\(N\)</span> の素因数を多項式時間で求めます。 Qiskit でのアルゴリズムの実装では、以下のように素因数分解する整数を与えるだけで実行できます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">shor</span> <span class="o">=</span> <span class="n">Shor</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">BasicAer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">)</span>
<span class="n">quantum_instance</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">shor</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">quantum_instance</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The list of factors of </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2"> as computed by the Shor&#39;s algorithm is </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The list of factors of 15 as computed by the Shor&#39;s algorithm is [3, 5].
</pre></div></div>
</div>
<p>注: Shor のアルゴリズムのこの実装は、<span class="math notranslate nohighlight">\(n\)</span> を二進表示された入力整数のビット数として、 <span class="math notranslate nohighlight">\(4n + 2\)</span> 量子ビット用いています。したがって実際には今のところ、小さな整数の素因数分解に限定されています。上記の N の値があたえられているので、以下に <span class="math notranslate nohighlight">\(4n +2\)</span> を計算し、実際の回路サイズを確認します。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Computed of qubits for circuit: </span><span class="si">{</span><span class="mi">4</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Actual number of qubits of circuit: </span><span class="si">{</span><span class="n">shor</span><span class="o">.</span><span class="n">construct_circuit</span><span class="p">()</span><span class="o">.</span><span class="n">num_qubits</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Computed of qubits for circuit: 18
Actual number of qubits of circuit: 18
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">qiskit.tools.jupyter</span>
<span class="o">%</span><span class="k">qiskit_version_table</span>
<span class="o">%</span><span class="k">qiskit_copyright</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<h3>Version Information</h3><table><tr><th>Qiskit Software</th><th>Version</th></tr><tr><td>Qiskit</td><td>0.23.0</td></tr><tr><td>Terra</td><td>0.16.0</td></tr><tr><td>Aer</td><td>0.7.0</td></tr><tr><td>Ignis</td><td>0.5.0</td></tr><tr><td>Aqua</td><td>0.8.0</td></tr><tr><td>IBM Q Provider</td><td>0.11.0</td></tr><tr><th>System information</th></tr><tr><td>Python</td><td>3.6.1 |Continuum Analytics, Inc.| (default, May 11 2017, 13:09:58)
[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]</td></tr><tr><td>OS</td><td>Linux</td></tr><tr><td>CPUs</td><td>1</td></tr><tr><td>Memory (Gb)</td><td>5.827335357666016</td></tr><tr><td colspan='2'>Sun Nov 08 16:49:50 2020 EST</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style='width: 100%; background-color:#d5d9e0;padding-left: 10px; padding-bottom: 10px; padding-right: 10px; padding-top: 5px'><h3>This code is a part of Qiskit</h3><p>&copy; Copyright IBM 2017, 2020.</p><p>This code is licensed under the Apache License, Version 2.0. You may<br>obtain a copy of this license in the LICENSE.txt file in the root directory<br> of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.<p>Any modifications or derivative works of this code must retain this<br>copyright notice, and modified files need to carry a notice indicating<br>that they have been altered from the originals.</p></div></div>
</div>
</section>
</section>


             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Qiskit Development Team.
      最終更新: 2021/05/19

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">教科書的なアルゴリズムと Shor のアルゴリズム</a><ul>
<li><a class="reference internal" href="#Deutsch-Jozsa-のアルゴリズム">Deutsch-Jozsa のアルゴリズム</a></li>
<li><a class="reference internal" href="#Bernstein-Vazirani-のアルゴリズム">Bernstein-Vazirani のアルゴリズム</a></li>
<li><a class="reference internal" href="#Simon-のアルゴリズム">Simon のアルゴリズム</a></li>
<li><a class="reference internal" href="#Shor-の素因数分解アルゴリズム">Shor の素因数分解アルゴリズム</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
         <script src="../../_static/jquery.js"></script>
         <script src="../../_static/underscore.js"></script>
         <script src="../../_static/doctools.js"></script>
         <script src="../../_static/language_data.js"></script>
         <script src="../../_static/thebelab-helper.js"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^0.21.0-alpha.0/dist/embed-amd.js"></script>
         <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
         <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
     

  

  <script type="text/javascript" src="../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <div>
    <br>
  </div>

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="../../getting_started.html">Getting Started</a>
          </li>
          <li>
            <a href="../../tutorials.html">Tutorials</a>
          </li>
          <li>
            <a href="https://qiskit.org/documentation/partners/">Providers</a>
          </li>
          <br>
          <li class="resources-mobile-menu-title">
            Applications
          </li>
          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://qiskit.org/documentation/machine-learning/">Machine learning</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/nature/">Nature</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/finance/">Finance</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/optimization/">Optimization</a>
            </li>
          </ul>

          <br>

          <li class="resources-mobile-menu-title">
            Resources
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://qiskit.slack.com">Slack support</a>
            </li>
          </ul>
          <br>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>