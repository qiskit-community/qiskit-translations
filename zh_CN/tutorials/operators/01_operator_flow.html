


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Operator Flow &mdash; Qiskit 0.27.0 文档</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme-override.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-variables.ade9f9d55df9d2893fc676ecd59723a1.css" type="text/css" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="../../getting_started.html">Getting started</a>
          </li>

          <li>
            <a href="../../tutorials.html">Tutorials</a>
          </li>

          <li>
            <a href="https://qiskit.org/documentation/partners/" target="_blank">Providers</a>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Applications
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/machine-learning/">
                  <span class="dropdown-title">Machine learning</span>
                  <p>QSVM, VQC (Variational Quantum Classifier), and QGAN (Quantum Generative
                    Adversarial Network) algorithms.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/nature/">
                  <span class="dropdown-title">Nature</span>
                  <p>Quantum applications in chemistry, physics, and biology.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/finance/">
                  <span class="dropdown-title">Finance</span>
                  <p>Uncertainty components for stock/securities problems, Ising translators for
                    portfolio optimizations and data providers to source real or random data.</p>
                </a>
                <a class="nav-dropdown-item" href="https://qiskit.org/documentation/optimization/">
                  <span class="dropdown-title">Optimization</span>
                  <p>High-level optimization problems that are ready to
                    run on simulators and real quantum devices</p>
                </a>
              </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.slack.com">
                  <span class="dropdown-title">Slack support</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.org/textbook">
                  <span class="dropdown-title">Qiskit Textbook</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://qiskit.org/events">
                  <span class="dropdown-title">Qiskit events</span>
                  <p></p>
                </a>
            </div>
          </li>
          <li>
            <a href="https://github.com/Qiskit/" target="_blank">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="rst-current-version-label">zh_CN</span>
    <span class="rst-versions-dropdown-icon"></span>
  </span>
  <div class="rst-other-versions">
    
    <dl>
      <dt>Languages</dt>
      
        <dd><a class="version" href="/documentation/tutorials/operators/01_operator_flow.html">English</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ja_JP/tutorials/operators/01_operator_flow.html">Japanese</a></dd>
      
        <dd><a class="version" href="/documentation/locale/de_DE/tutorials/operators/01_operator_flow.html">German</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ko_KR/tutorials/operators/01_operator_flow.html">Korean</a></dd>
      
        <dd><a class="version" href="/documentation/locale/pt_BR/tutorials/operators/01_operator_flow.html">Portuguese, Brazilian</a></dd>
      
        <dd><a class="version" href="/documentation/locale/fr_FR/tutorials/operators/01_operator_flow.html">French</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ta_IN/tutorials/operators/01_operator_flow.html">Tamil</a></dd>
      
    </dl>
    
    <dl>
      <dt>Previous Releases</dt>
      
        <dd><a class="version" href="/documentation/stable/0.24/index.html">0.24</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.25/index.html">0.25</a></dd>
      
        <dd><a class="version" href="/documentation/stable/0.26/index.html">0.26</a></dd>
      
    </dl>
  </div>
  <script>
    jQuery('.version').click((evt) => {
      const hash = window.location.hash
      const complete_url = evt.target.href + hash
      window.location = complete_url
      evt.preventDefault()
    })
  </script>
</div>

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Documentation homepage</a></li>
</ul>
<p><span class="caption-text">Frontmatter</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../qc_intro.html">Quantum computing in a nutshell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro_tutorial1.html">Introduction to Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing_to_qiskit.html">Contributing to Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Local Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
</ul>
<p><span class="caption-text">Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/circuit_library.html">Circuit Library</a></li>
</ul>
<p><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/terra.html">Qiskit (Terra)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/aer.html">Qiskit Simulator (Aer)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ignis.html">Qiskit Experiments (Ignis)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/aqua.html">Qiskit Application Modules (Aqua)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ibmq-provider.html">Qiskit IBM Quantum (Provider)</a></li>
</ul>
<p><span class="caption-text">Qiskit Applications (Aqua) Migration Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../aqua_migration.html">Qiskit Applications (Aqua) Migration Guide</a></li>
</ul>
<p><span class="caption-text">Troubleshooting</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://quantum-computing.ibm.com/lab/docs/iql/manage/errors">IBM Quantum API error codes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Operator Flow</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/operators/01_operator_flow.ipynb" rel="nofollow"><img src="../../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">
          
          <div class="rst-content style-external-links">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>This page was generated from <a class="reference external" href="https://github.com/Qiskit/qiskit-tutorials/blob/master/tutorials/operators/01_operator_flow.ipynb">tutorials/operators/01_operator_flow.ipynb</a>.</p>
</div>
<section id="Operator-Flow">
<h1>Operator Flow<a class="headerlink" href="#Operator-Flow" title="永久链接至标题">¶</a></h1>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="永久链接至标题">¶</a></h2>
<p>Qiskit provides classes representing states and operators and sums, tensor products, and compositions thereof. These algebraic constructs allow us to build expressions representing operators.</p>
<p>We introduce expressions by building them from Pauli operators. In subsequent sections we explore in more detail operators and states, how they are represented, and what we can do with them. In the last section we construct a state, evolve it with a Hamiltonian, and compute expectation values of an observable.</p>
<section id="Pauli-operators,-sums,-compositions,-and-tensor-products">
<h3>Pauli operators, sums, compositions, and tensor products<a class="headerlink" href="#Pauli-operators,-sums,-compositions,-and-tensor-products" title="永久链接至标题">¶</a></h3>
<p>The most important base operators are the Pauli operators. The Pauli operators are represented like this.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.opflow</span> <span class="kn">import</span> <span class="n">I</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span>
<span class="nb">print</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
I X Y Z
</pre></div></div>
</div>
<p>These operators may also carry a coefficient.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">I</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.5 * I
2.5 * X
</pre></div></div>
</div>
<p>These coefficients allow the operators to be used as terms in a sum.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0 * X
+ 2.0 * Y
</pre></div></div>
</div>
<p>Tensor products are denoted with a caret, like this.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">^</span><span class="n">Y</span><span class="o">^</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
XYZ
</pre></div></div>
</div>
<p>Composition is denoted by the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> symbol.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">X</span> <span class="o">@</span> <span class="n">Y</span> <span class="o">@</span> <span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
iI
</pre></div></div>
</div>
<p>In the preceding two examples, the tensor product and composition of Pauli operators were immediately reduced to the equivalent (possibly multi-qubit) Pauli operator. If we tensor or compose more complicated objects, the result is objects representing the unevaluated operations. That is, algebraic expressions.</p>
<p>For example, composing two sums gives</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">((</span><span class="n">X</span> <span class="o">+</span> <span class="n">Y</span><span class="p">)</span> <span class="o">@</span> <span class="p">(</span><span class="n">Y</span> <span class="o">+</span> <span class="n">Z</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1j * Z
+ -1j * Y
+ 1.0 * I
+ 1j * X
</pre></div></div>
</div>
<p>And tensoring two sums gives</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">((</span><span class="n">X</span> <span class="o">+</span> <span class="n">Y</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">Y</span> <span class="o">+</span> <span class="n">Z</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0 * XY
+ 1.0 * XZ
+ 1.0 * YY
+ 1.0 * YZ
</pre></div></div>
</div>
<p>Let’s take a closer look at the types introduced above. First the Pauli operators.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(PauliOp(Pauli(&#39;I&#39;), coeff=1.0), PauliOp(Pauli(&#39;X&#39;), coeff=1.0))
</pre></div></div>
</div>
<p>Each Pauli operator is an instance of <code class="docutils literal notranslate"><span class="pre">PauliOp</span></code>, which wraps an instance of <code class="docutils literal notranslate"><span class="pre">qiskit.quantum_info.Pauli</span></code>, and adds a coefficient <code class="docutils literal notranslate"><span class="pre">coeff</span></code>. In general, a <code class="docutils literal notranslate"><span class="pre">PauliOp</span></code> represents a weighted tensor product of Pauli operators.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">X</span><span class="o">^</span><span class="n">Y</span><span class="o">^</span><span class="n">Z</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PauliOp(Pauli(&#39;XYZ&#39;), coeff=2.0)
</pre></div></div>
</div>
<p>For the encoding of the Pauli operators as pairs of Boolean values, see the documentation for <code class="docutils literal notranslate"><span class="pre">qiskit.quantum_info.Pauli</span></code>.</p>
<p>All of the objects representing operators, whether as “primitive”s such as <code class="docutils literal notranslate"><span class="pre">PauliOp</span></code>, or algebraic expressions carry a coefficient</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="mf">1.1</span> <span class="o">*</span> <span class="p">((</span><span class="mf">1.2</span> <span class="o">*</span> <span class="n">X</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="n">Y</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.3</span> <span class="o">*</span> <span class="n">Z</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.2 * (
  1.1 * XY
  + 1.4300000000000002 * XZ
)
</pre></div></div>
</div>
<p>In the following we take a broader and deeper look at Qiskit’s operators, states, and the building blocks of quantum algorithms.</p>
</section>
</section>
<section id="Part-I:-State-Functions-and-Measurements">
<h2>Part I: State Functions and Measurements<a class="headerlink" href="#Part-I:-State-Functions-and-Measurements" title="永久链接至标题">¶</a></h2>
<p>Quantum states are represented by subclasses of the class <code class="docutils literal notranslate"><span class="pre">StateFn</span></code>. There are four representations of quantum states: <code class="docutils literal notranslate"><span class="pre">DictStateFn</span></code> is a sparse representation in the computational basis, backed by a <code class="docutils literal notranslate"><span class="pre">dict</span></code>. <code class="docutils literal notranslate"><span class="pre">VectorStateFn</span></code> is a dense representation in the computational basis backed by a numpy array. <code class="docutils literal notranslate"><span class="pre">CircuitStateFn</span></code> is backed by a circuit and represents the state obtained by executing the circuit on the all-zero computational-basis state. <code class="docutils literal notranslate"><span class="pre">OperatorStateFn</span></code> represents mixed states
via a density matrix. (As we will see later, <code class="docutils literal notranslate"><span class="pre">OperatorStateFn</span></code> is also used to represent observables.)</p>
<p>Several <code class="docutils literal notranslate"><span class="pre">StateFn</span></code> instances are provided for convenience. For example <code class="docutils literal notranslate"><span class="pre">Zero,</span> <span class="pre">One,</span> <span class="pre">Plus,</span> <span class="pre">Minus</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.opflow</span> <span class="kn">import</span> <span class="p">(</span><span class="n">StateFn</span><span class="p">,</span> <span class="n">Zero</span><span class="p">,</span> <span class="n">One</span><span class="p">,</span> <span class="n">Plus</span><span class="p">,</span> <span class="n">Minus</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span>
                           <span class="n">DictStateFn</span><span class="p">,</span> <span class="n">VectorStateFn</span><span class="p">,</span> <span class="n">CircuitStateFn</span><span class="p">,</span> <span class="n">OperatorStateFn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Zero</span></code> and <code class="docutils literal notranslate"><span class="pre">One</span></code> represent the quantum states <span class="math notranslate nohighlight">\(|0\rangle\)</span> and <span class="math notranslate nohighlight">\(|1\rangle\)</span>. They are represented via <code class="docutils literal notranslate"><span class="pre">DictStateFn</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">Zero</span><span class="p">,</span> <span class="n">One</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DictStateFn({&#39;0&#39;: 1}) DictStateFn({&#39;1&#39;: 1})
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Plus</span></code> and <code class="docutils literal notranslate"><span class="pre">Minus</span></code>, representing states <span class="math notranslate nohighlight">\((|0\rangle + |1\rangle)/\sqrt{2}\)</span> and <span class="math notranslate nohighlight">\((|0\rangle - |1\rangle)/\sqrt{2}\)</span> are represented via circuits. <code class="docutils literal notranslate"><span class="pre">H</span></code> is a synonym for <code class="docutils literal notranslate"><span class="pre">Plus</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">Plus</span><span class="p">,</span> <span class="n">Minus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CircuitStateFn(
     ┌───┐
q_0: ┤ H ├
     └───┘
) CircuitStateFn(
     ┌───┐┌───┐
q_0: ┤ X ├┤ H ├
     └───┘└───┘
)
</pre></div></div>
</div>
<p>Indexing into quantum states is done with the <code class="docutils literal notranslate"><span class="pre">eval</span></code> method. These examples return the coefficients of the <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span></code> basis states. (Below, we will see that the <code class="docutils literal notranslate"><span class="pre">eval</span></code> method is used for other computations, as well.)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">Zero</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Zero</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">One</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Plus</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Minus</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
0.0
1.0
(0.7071067811865475+0j)
(-0.7071067811865475+8.7e-17j)
</pre></div></div>
</div>
<p>The dual vector of a quantum state, that is the <em>bra</em> corresponding to a <em>ket</em> is obtained via the <code class="docutils literal notranslate"><span class="pre">adjoint</span></code> method. The <code class="docutils literal notranslate"><span class="pre">StateFn</span></code> carries a flag <code class="docutils literal notranslate"><span class="pre">is_measurement</span></code>, which is <code class="docutils literal notranslate"><span class="pre">False</span></code> if the object is a ket and <code class="docutils literal notranslate"><span class="pre">True</span></code> if it is a bra.</p>
<p>Here, we construct <span class="math notranslate nohighlight">\(\langle 1 |\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">One</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DictStateFn({&#39;1&#39;: 1}, coeff=1.0, is_measurement=True)
</pre></div></div>
</div>
<p>For convenience, one may obtain the dual vector with a tilde, like this</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">~</span><span class="n">One</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DictStateFn({&#39;1&#39;: 1}, coeff=1.0, is_measurement=True)
</pre></div></div>
</div>
<section id="Algebraic-operations-and-predicates">
<h3>Algebraic operations and predicates<a class="headerlink" href="#Algebraic-operations-and-predicates" title="永久链接至标题">¶</a></h3>
<p>Many algebraic operations and predicates between <code class="docutils literal notranslate"><span class="pre">StateFn</span></code>s are supported, including: * <code class="docutils literal notranslate"><span class="pre">+</span></code> - addition * <code class="docutils literal notranslate"><span class="pre">-</span></code> - subtraction, negation (scalar multiplication by -1) * <code class="docutils literal notranslate"><span class="pre">*</span></code> - scalar multiplication * <code class="docutils literal notranslate"><span class="pre">/</span></code> - scalar division * <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> - composition * <code class="docutils literal notranslate"><span class="pre">^</span></code> - tensor product or tensor power (tensor with self n times) * <code class="docutils literal notranslate"><span class="pre">**</span></code> - composition power (compose with self n times) * <code class="docutils literal notranslate"><span class="pre">==</span></code> - equality * <code class="docutils literal notranslate"><span class="pre">~</span></code> - adjoint, alternating between a State Function and Measurement</p>
<p>Be aware that parentheses are often necessary to override <strong>operator precedence</strong>.</p>
<p><code class="docutils literal notranslate"><span class="pre">StateFn</span></code>s carry a coefficient. This allows us multiply states by a scalar, and so to construct sums.</p>
<p>Here, we construct <span class="math notranslate nohighlight">\((2 + 3i)|0\rangle\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mf">3.0</span><span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="n">Zero</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DictStateFn({&#39;0&#39;: 1}, coeff=(2+3j), is_measurement=False)
</pre></div></div>
</div>
<p>Here, we see that adding two <code class="docutils literal notranslate"><span class="pre">DictStateFn</span></code>s returns an object of the same type. We construct <span class="math notranslate nohighlight">\(|0\rangle + |1\rangle\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">Zero</span> <span class="o">+</span> <span class="n">One</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DictStateFn({&#39;0&#39;: 1.0, &#39;1&#39;: 1.0})
</pre></div></div>
</div>
<p>Note that you must normalize states by hand. For example, to construct <span class="math notranslate nohighlight">\((|0\rangle + |1\rangle)/\sqrt{2}\)</span>, we write</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="n">v_zero_one</span> <span class="o">=</span> <span class="p">(</span><span class="n">Zero</span> <span class="o">+</span> <span class="n">One</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">v_zero_one</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DictStateFn({&#39;0&#39;: 1.0, &#39;1&#39;: 1.0}) * 0.7071067811865475
</pre></div></div>
</div>
<p>In other cases, the result is a symbolic representation of a sum. For example, here is a representation of <span class="math notranslate nohighlight">\(|+\rangle + |-\rangle\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">Plus</span> <span class="o">+</span> <span class="n">Minus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SummedOp([
  CircuitStateFn(
       ┌───┐
  q_0: ┤ H ├
       └───┘
  ),
  CircuitStateFn(
       ┌───┐┌───┐
  q_0: ┤ X ├┤ H ├
       └───┘└───┘
  )
])
</pre></div></div>
</div>
<p>The composition operator is used to perform an inner product, which by default is held in an unevaluated form. Here is a representation of <span class="math notranslate nohighlight">\(\langle 1 | 1 \rangle\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="o">~</span><span class="n">One</span> <span class="o">@</span> <span class="n">One</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ComposedOp([
  DictMeasurement({&#39;1&#39;: 1}),
  DictStateFn({&#39;1&#39;: 1})
])
</pre></div></div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">is_measurement</span></code> flag causes the (bra) state <code class="docutils literal notranslate"><span class="pre">~One</span></code> to be printed <code class="docutils literal notranslate"><span class="pre">DictMeasurement</span></code>.</p>
<p>Symbolic expressions may be evaluated with the <code class="docutils literal notranslate"><span class="pre">eval</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="o">~</span><span class="n">One</span> <span class="o">@</span> <span class="n">One</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="o">~</span><span class="n">v_zero_one</span> <span class="o">@</span> <span class="n">v_zero_one</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9999999999999998
</pre></div></div>
</div>
<p>Here is <span class="math notranslate nohighlight">\(\langle - | 1 \rangle = \langle (\langle 0| - \langle 1|)/\sqrt{2} | 1\rangle\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="o">~</span><span class="n">Minus</span> <span class="o">@</span> <span class="n">One</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-0.7071067811865475-8.7e-17j)
</pre></div></div>
</div>
<p>The composition operator <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> is equivalent to calling the <code class="docutils literal notranslate"><span class="pre">compose</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">((</span><span class="o">~</span><span class="n">One</span><span class="p">)</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">One</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ComposedOp([
  DictMeasurement({&#39;1&#39;: 1}),
  DictStateFn({&#39;1&#39;: 1})
])
</pre></div></div>
</div>
<p>Inner products may also be computed using the <code class="docutils literal notranslate"><span class="pre">eval</span></code> method directly, without constructing a <code class="docutils literal notranslate"><span class="pre">ComposedOp</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="o">~</span><span class="n">One</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">One</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
<p>Symbolic tensor products are constructed as follows. Here is <span class="math notranslate nohighlight">\(|0\rangle \otimes |+\rangle\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">Zero</span><span class="o">^</span><span class="n">Plus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TensoredOp([
  DictStateFn({&#39;0&#39;: 1}),
  CircuitStateFn(
       ┌───┐
  q_0: ┤ H ├
       └───┘
  )
])
</pre></div></div>
</div>
<p>This may be represented as a simple (not compound) <code class="docutils literal notranslate"><span class="pre">CircuitStateFn</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">((</span><span class="n">Zero</span><span class="o">^</span><span class="n">Plus</span><span class="p">)</span><span class="o">.</span><span class="n">to_circuit_op</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CircuitStateFn(
     ┌───┐
q_0: ┤ H ├
     └───┘
q_1: ─────

)
</pre></div></div>
</div>
<p>Tensor powers are constructed using the caret <code class="docutils literal notranslate"><span class="pre">^</span></code> as follows. Here are <span class="math notranslate nohighlight">\(600 (|11111\rangle + |00000\rangle)\)</span>, and <span class="math notranslate nohighlight">\(|10\rangle^{\otimes 3}\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="mi">600</span> <span class="o">*</span> <span class="p">((</span><span class="n">One</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Zero</span><span class="o">^</span><span class="mi">5</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">((</span><span class="n">One</span><span class="o">^</span><span class="n">Zero</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DictStateFn({&#39;11111&#39;: 1.0, &#39;00000&#39;: 1.0}) * 600.0
DictStateFn({&#39;101010&#39;: 1})
</pre></div></div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">to_matrix_op</span></code> converts to <code class="docutils literal notranslate"><span class="pre">VectorStateFn</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(((</span><span class="n">Plus</span><span class="o">^</span><span class="n">Minus</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_matrix_op</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(((</span><span class="n">Plus</span><span class="o">^</span><span class="n">One</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_circuit_op</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(((</span><span class="n">Plus</span><span class="o">^</span><span class="n">One</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_matrix_op</span><span class="p">()</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
VectorStateFn(Statevector([ 0.25-6.1e-17j, -0.25+6.1e-17j,  0.25-6.1e-17j,
             -0.25+6.1e-17j, -0.25+6.1e-17j,  0.25-6.1e-17j,
             -0.25+6.1e-17j,  0.25-6.1e-17j,  0.25-6.1e-17j,
             -0.25+6.1e-17j,  0.25-6.1e-17j, -0.25+6.1e-17j,
             -0.25+6.1e-17j,  0.25-6.1e-17j, -0.25+6.1e-17j,
              0.25-6.1e-17j],
            dims=(2, 2, 2, 2)))
CircuitStateFn(
     ┌───┐
q_0: ┤ X ├
     ├───┤
q_1: ┤ H ├
     ├───┤
q_2: ┤ X ├
     ├───┤
q_3: ┤ H ├
     └───┘
)
{&#39;0101&#39;: 0.2685546875, &#39;0111&#39;: 0.2607421875, &#39;1101&#39;: 0.236328125, &#39;1111&#39;: 0.234375}
</pre></div></div>
</div>
<p>Constructing a StateFn is easy. The <code class="docutils literal notranslate"><span class="pre">StateFn</span></code> class also serves as a factory, and can take any applicable primitive in its constructor and return the correct StateFn subclass. Currently the following primitives can be passed into the constructor, listed alongside the <code class="docutils literal notranslate"><span class="pre">StateFn</span></code> subclass they produce:</p>
<ul class="simple">
<li><p>str (equal to some basis bitstring) -&gt; DictStateFn</p></li>
<li><p>dict -&gt; DictStateFn</p></li>
<li><p>Qiskit Result object -&gt; DictStateFn</p></li>
<li><p>list -&gt; VectorStateFn</p></li>
<li><p>np.ndarray -&gt; VectorStateFn</p></li>
<li><p>Statevector -&gt; VectorStateFn</p></li>
<li><p>QuantumCircuit -&gt; CircuitStateFn</p></li>
<li><p>Instruction -&gt; CircuitStateFn</p></li>
<li><p>OperatorBase -&gt; OperatorStateFn</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">StateFn</span><span class="p">({</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">StateFn</span><span class="p">({</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span> <span class="o">==</span> <span class="n">Zero</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">StateFn</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>

<span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">RealAmplitudes</span>
<span class="nb">print</span><span class="p">(</span><span class="n">StateFn</span><span class="p">(</span><span class="n">RealAmplitudes</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DictStateFn({&#39;0&#39;: 1})
True
VectorStateFn(Statevector([0.+0.j, 1.+0.j, 1.+0.j, 0.+0.j],
            dims=(2, 2)))
CircuitStateFn(
     ┌──────────┐     ┌──────────┐     ┌──────────┐     ┌──────────┐
q_0: ┤ RY(θ[0]) ├──■──┤ RY(θ[2]) ├──■──┤ RY(θ[4]) ├──■──┤ RY(θ[6]) ├
     ├──────────┤┌─┴─┐├──────────┤┌─┴─┐├──────────┤┌─┴─┐├──────────┤
q_1: ┤ RY(θ[1]) ├┤ X ├┤ RY(θ[3]) ├┤ X ├┤ RY(θ[5]) ├┤ X ├┤ RY(θ[7]) ├
     └──────────┘└───┘└──────────┘└───┘└──────────┘└───┘└──────────┘
)
</pre></div></div>
</div>
</section>
</section>
<section id="Part-II:-PrimitiveOps">
<h2>Part II: <code class="docutils literal notranslate"><span class="pre">PrimitiveOp</span></code>s<a class="headerlink" href="#Part-II:-PrimitiveOps" title="永久链接至标题">¶</a></h2>
<p>The basic Operators are subclasses of <code class="docutils literal notranslate"><span class="pre">PrimitiveOp</span></code>. Just like <code class="docutils literal notranslate"><span class="pre">StateFn</span></code>, <code class="docutils literal notranslate"><span class="pre">PrimitiveOp</span></code> is also a factory for creating the correct type of <code class="docutils literal notranslate"><span class="pre">PrimitiveOp</span></code> for a given primitive. Currently, the following primitives can be passed into the constructor, listed alongside the <code class="docutils literal notranslate"><span class="pre">PrimitiveOp</span></code> subclass they produce:</p>
<ul class="simple">
<li><p>Terra’s Pauli -&gt; PauliOp</p></li>
<li><p>Instruction -&gt; CircuitOp</p></li>
<li><p>QuantumCircuit -&gt; CircuitOp</p></li>
<li><p>2d List -&gt; MatrixOp</p></li>
<li><p>np.ndarray -&gt; MatrixOp</p></li>
<li><p>spmatrix -&gt; MatrixOp</p></li>
<li><p>Terra’s quantum_info.Operator -&gt; MatrixOp</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.opflow</span> <span class="kn">import</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">CX</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">PrimitiveOp</span>
</pre></div>
</div>
</div>
<section id="Matrix-elements">
<h3>Matrix elements<a class="headerlink" href="#Matrix-elements" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">eval</span></code> method returns a column from an operator. For example, the Pauli <span class="math notranslate nohighlight">\(X\)</span> operator is represented by a <code class="docutils literal notranslate"><span class="pre">PauliOp</span></code>. Asking for a column returns an instance of the sparse representation, a <code class="docutils literal notranslate"><span class="pre">DictStateFn</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PauliOp(Pauli(&#39;X&#39;), coeff=1.0)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DictStateFn({&#39;1&#39;: (1+0j)})
</pre></div></div>
</div>
<p>It follows that indexing into an operator, that is obtaining a matrix element, is performed with two calls to the <code class="docutils literal notranslate"><span class="pre">eval</span></code> method.</p>
<p>We have <span class="math notranslate nohighlight">\(X = \left(\begin{matrix} 0 &amp; 1 \\  1 &amp; 0  \end{matrix} \right)\)</span>. And the matrix element <span class="math notranslate nohighlight">\(\left\{X \right\}_{0,1}\)</span> is</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1+0j)
</pre></div></div>
</div>
<p>Here is an example using the two qubit operator <code class="docutils literal notranslate"><span class="pre">CX</span></code>, the controlled <code class="docutils literal notranslate"><span class="pre">X</span></code>, which is represented by a circuit.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">CX</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">CX</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="c1"># The imaginary part vanishes.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

q_0: ──■──
     ┌─┴─┐
q_1: ┤ X ├
     └───┘
[[1. 0. 0. 0.]
 [0. 0. 0. 1.]
 [0. 0. 1. 0.]
 [0. 1. 0. 0.]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">CX</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;01&#39;</span><span class="p">)</span>  <span class="c1"># 01 is the one in decimal. We get the first column.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
VectorStateFn(Statevector([0.+0.j, 0.+0.j, 0.+0.j, 1.+0.j],
            dims=(2, 2)), coeff=1.0, is_measurement=False)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">CX</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;01&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;11&#39;</span><span class="p">)</span>  <span class="c1"># This returns element with (zero-based) index (1, 3)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1+0j)
</pre></div></div>
</div>
</section>
<section id="Applying-an-operator-to-a-state-vector">
<h3>Applying an operator to a state vector<a class="headerlink" href="#Applying-an-operator-to-a-state-vector" title="永久链接至标题">¶</a></h3>
<p>Applying an operator to a state vector may be done with the <code class="docutils literal notranslate"><span class="pre">compose</span></code> method (equivalently, <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> operator). Here is a representation of <span class="math notranslate nohighlight">\(X | 1 \rangle = |0\rangle\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">X</span> <span class="o">@</span> <span class="n">One</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ComposedOp([
  X,
  DictStateFn({&#39;1&#39;: 1})
])
</pre></div></div>
</div>
<p>A simpler representation, the <code class="docutils literal notranslate"><span class="pre">DictStateFn</span></code> representation of <span class="math notranslate nohighlight">\(|0\rangle\)</span>, is obtained with <code class="docutils literal notranslate"><span class="pre">eval</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">X</span> <span class="o">@</span> <span class="n">One</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DictStateFn({&#39;0&#39;: (1+0j)}, coeff=(1+0j), is_measurement=False)
</pre></div></div>
</div>
<p>The intermediate <code class="docutils literal notranslate"><span class="pre">ComposedOp</span></code> step may be avoided by using <code class="docutils literal notranslate"><span class="pre">eval</span></code> directly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">One</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DictStateFn({&#39;0&#39;: (1+0j)}, coeff=(1+0j), is_measurement=False)
</pre></div></div>
</div>
<p>Composition and tensor products of operators are effected with <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> and <code class="docutils literal notranslate"><span class="pre">^</span></code>. Here are some examples.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(((</span><span class="o">~</span><span class="n">One</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <span class="p">(</span><span class="n">CX</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;01&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(((</span><span class="n">H</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span> <span class="o">@</span> <span class="p">((</span><span class="n">CX</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="n">I</span><span class="p">)</span> <span class="o">@</span> <span class="p">(</span><span class="n">I</span><span class="o">^</span><span class="p">(</span><span class="n">CX</span><span class="o">^</span><span class="mi">2</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((((</span><span class="n">H</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span> <span class="o">@</span> <span class="p">((</span><span class="n">CX</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="n">I</span><span class="p">)</span> <span class="o">@</span> <span class="p">(</span><span class="n">I</span><span class="o">^</span><span class="p">(</span><span class="n">CX</span><span class="o">^</span><span class="mi">2</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <span class="p">(</span><span class="n">Minus</span><span class="o">^</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(((</span><span class="n">H</span><span class="o">^</span><span class="n">I</span><span class="o">^</span><span class="n">I</span><span class="p">)</span><span class="o">@</span><span class="p">(</span><span class="n">X</span><span class="o">^</span><span class="n">I</span><span class="o">^</span><span class="n">I</span><span class="p">)</span><span class="nd">@Zero</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1+0j)
          ┌───┐┌───┐     ┌───┐┌───┐
q_0: ──■──┤ I ├┤ H ├──■──┤ I ├┤ H ├
     ┌─┴─┐└───┘├───┤┌─┴─┐└───┘├───┤
q_1: ┤ X ├──■──┤ H ├┤ X ├──■──┤ H ├
     └───┘┌─┴─┐├───┤└───┘┌─┴─┐├───┤
q_2: ──■──┤ X ├┤ H ├──■──┤ X ├┤ H ├
     ┌─┴─┐└───┘├───┤┌─┴─┐└───┘├───┤
q_3: ┤ X ├──■──┤ H ├┤ X ├──■──┤ H ├
     ├───┤┌─┴─┐├───┤├───┤┌─┴─┐├───┤
q_4: ┤ I ├┤ X ├┤ H ├┤ I ├┤ X ├┤ H ├
     └───┘└───┘└───┘└───┘└───┘└───┘
CircuitStateFn(
     ┌───┐┌───┐     ┌───┐          ┌───┐
q_0: ┤ X ├┤ H ├──■──┤ H ├───────■──┤ H ├─────
     ├───┤├───┤┌─┴─┐└───┘┌───┐┌─┴─┐└───┘┌───┐
q_1: ┤ X ├┤ H ├┤ X ├──■──┤ H ├┤ X ├──■──┤ H ├
     ├───┤├───┤└───┘┌─┴─┐├───┤└───┘┌─┴─┐├───┤
q_2: ┤ X ├┤ H ├──■──┤ X ├┤ H ├──■──┤ X ├┤ H ├
     ├───┤├───┤┌─┴─┐└───┘├───┤┌─┴─┐└───┘├───┤
q_3: ┤ X ├┤ H ├┤ X ├──■──┤ H ├┤ X ├──■──┤ H ├
     ├───┤├───┤└───┘┌─┴─┐├───┤└───┘┌─┴─┐├───┤
q_4: ┤ X ├┤ H ├─────┤ X ├┤ H ├─────┤ X ├┤ H ├
     └───┘└───┘     └───┘└───┘     └───┘└───┘
)
CircuitStateFn(

q_0: ──────────

q_1: ──────────
     ┌───┐┌───┐
q_2: ┤ X ├┤ H ├
     └───┘└───┘
)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="o">~</span><span class="n">One</span> <span class="o">@</span> <span class="n">Minus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ComposedOp([
  DictMeasurement({&#39;1&#39;: 1}),
  CircuitStateFn(
       ┌───┐┌───┐
  q_0: ┤ X ├┤ H ├
       └───┘└───┘
  )
])
</pre></div></div>
</div>
</section>
</section>
<section id="Part-III-ListOp-and-subclasses">
<h2>Part III <code class="docutils literal notranslate"><span class="pre">ListOp</span></code> and subclasses<a class="headerlink" href="#Part-III-ListOp-and-subclasses" title="永久链接至标题">¶</a></h2>
<section id="ListOp">
<h3><code class="docutils literal notranslate"><span class="pre">ListOp</span></code><a class="headerlink" href="#ListOp" title="永久链接至标题">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ListOp</span></code> is a container for effectively vectorizing operations over a list of operators and states.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.opflow</span> <span class="kn">import</span> <span class="n">ListOp</span>

<span class="nb">print</span><span class="p">((</span><span class="o">~</span><span class="n">ListOp</span><span class="p">([</span><span class="n">One</span><span class="p">,</span> <span class="n">Zero</span><span class="p">])</span> <span class="o">@</span> <span class="n">ListOp</span><span class="p">([</span><span class="n">One</span><span class="p">,</span> <span class="n">Zero</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ComposedOp([
  ListOp([
    DictMeasurement({&#39;1&#39;: 1}),
    DictMeasurement({&#39;0&#39;: 1})
  ]),
  ListOp([
    DictStateFn({&#39;1&#39;: 1}),
    DictStateFn({&#39;0&#39;: 1})
  ])
])
</pre></div></div>
</div>
<p>For example, the composition above is distributed over the lists (<code class="docutils literal notranslate"><span class="pre">ListOp</span></code>) using the simplification method <code class="docutils literal notranslate"><span class="pre">reduce</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">((</span><span class="o">~</span><span class="n">ListOp</span><span class="p">([</span><span class="n">One</span><span class="p">,</span> <span class="n">Zero</span><span class="p">])</span> <span class="o">@</span> <span class="n">ListOp</span><span class="p">([</span><span class="n">One</span><span class="p">,</span> <span class="n">Zero</span><span class="p">]))</span><span class="o">.</span><span class="n">reduce</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ListOp([
  ListOp([
    ComposedOp([
      DictMeasurement({&#39;1&#39;: 1}),
      DictStateFn({&#39;1&#39;: 1})
    ]),
    ComposedOp([
      DictMeasurement({&#39;1&#39;: 1}),
      DictStateFn({&#39;0&#39;: 1})
    ])
  ]),
  ListOp([
    ComposedOp([
      DictMeasurement({&#39;0&#39;: 1}),
      DictStateFn({&#39;1&#39;: 1})
    ]),
    ComposedOp([
      DictMeasurement({&#39;0&#39;: 1}),
      DictStateFn({&#39;0&#39;: 1})
    ])
  ])
])
</pre></div></div>
</div>
</section>
<section id="ListOps:-SummedOp,-ComposedOp,-TensoredOp">
<h3><code class="docutils literal notranslate"><span class="pre">ListOp</span></code>s: <code class="docutils literal notranslate"><span class="pre">SummedOp</span></code>, <code class="docutils literal notranslate"><span class="pre">ComposedOp</span></code>, <code class="docutils literal notranslate"><span class="pre">TensoredOp</span></code><a class="headerlink" href="#ListOps:-SummedOp,-ComposedOp,-TensoredOp" title="永久链接至标题">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ListOp</span></code>, introduced above, is useful for vectorizing operations. But, it also serves as the superclass for list-like composite classes. If you’ve already played around with the above, you’ll notice that you can easily perform operations between <code class="docutils literal notranslate"><span class="pre">OperatorBase</span></code>s which we may not know how to perform efficiently in general (or simply haven’t implemented an efficient procedure for yet), such as addition between <code class="docutils literal notranslate"><span class="pre">CircuitOp</span></code>s. In those cases, you may receive a <code class="docutils literal notranslate"><span class="pre">ListOp</span></code> result (or subclass
thereof) from your operation representing the lazy execution of the operation. For example, if you attempt to add together a <code class="docutils literal notranslate"><span class="pre">DictStateFn</span></code> and a <code class="docutils literal notranslate"><span class="pre">CircuitStateFn</span></code>, you’ll receive a <code class="docutils literal notranslate"><span class="pre">SummedOp</span></code> representing the sum of the two. This composite State function still has a working <code class="docutils literal notranslate"><span class="pre">eval</span></code> (but may need to perform a non-scalable computation under the hood, such as converting both to vectors).</p>
<p>These composite <code class="docutils literal notranslate"><span class="pre">OperatorBase</span></code>s are how we construct increasingly complex and rich computation out of <code class="docutils literal notranslate"><span class="pre">PrimitiveOp</span></code> and <code class="docutils literal notranslate"><span class="pre">StateFn</span></code> building blocks.</p>
<p>Every <code class="docutils literal notranslate"><span class="pre">ListOp</span></code> has four properties: * <code class="docutils literal notranslate"><span class="pre">oplist</span></code> - The list of <code class="docutils literal notranslate"><span class="pre">OperatorBase</span></code>s which may represent terms, factors, etc. * <code class="docutils literal notranslate"><span class="pre">combo_fn</span></code> - The function taking a list of complex numbers to an output value which defines how to combine the outputs of the <code class="docutils literal notranslate"><span class="pre">oplist</span></code> items. For broadcasting simplicity, this function is defined over NumPy arrays. * <code class="docutils literal notranslate"><span class="pre">coeff</span></code> - A coefficient multiplying the primitive. Note that <code class="docutils literal notranslate"><span class="pre">coeff</span></code> can be int, float, complex or a free <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> object (from
<code class="docutils literal notranslate"><span class="pre">qiskit.circuit</span></code> in Terra) to be bound later using <code class="docutils literal notranslate"><span class="pre">my_op.bind_parameters</span></code>. * <code class="docutils literal notranslate"><span class="pre">abelian</span></code> - Indicates whether the Operators in <code class="docutils literal notranslate"><span class="pre">oplist</span></code> are known to mutually commute (usually set after being converted by the <code class="docutils literal notranslate"><span class="pre">AbelianGrouper</span></code> converter).</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">ListOp</span></code> supports typical iteration overloads, so you can use indexing like <code class="docutils literal notranslate"><span class="pre">my_op[4]</span></code> to access the <code class="docutils literal notranslate"><span class="pre">OperatorBase</span></code>s in <code class="docutils literal notranslate"><span class="pre">oplist</span></code>.</p>
</section>
<section id="OperatorStateFn">
<h3><code class="docutils literal notranslate"><span class="pre">OperatorStateFn</span></code><a class="headerlink" href="#OperatorStateFn" title="永久链接至标题">¶</a></h3>
<p>We mentioned above that <code class="docutils literal notranslate"><span class="pre">OperatorStateFn</span></code> represents a density operator. But, if the <code class="docutils literal notranslate"><span class="pre">is_measurement</span></code> flag is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then <code class="docutils literal notranslate"><span class="pre">OperatorStateFn</span></code> represents an observable. The expectation value of this observable can then be constructed via <code class="docutils literal notranslate"><span class="pre">ComposedOp</span></code>. Or, directly, using <code class="docutils literal notranslate"><span class="pre">eval</span></code>. Recall that the <code class="docutils literal notranslate"><span class="pre">is_measurement</span></code> flag (property) is set via the <code class="docutils literal notranslate"><span class="pre">adjoint</span></code> method.</p>
<p>Here we construct the observable corresponding to the Pauli <span class="math notranslate nohighlight">\(Z\)</span> operator. Note that when printing, it is called <code class="docutils literal notranslate"><span class="pre">OperatorMeasurement</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">StateFn</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="n">adjoint</span><span class="p">())</span>
<span class="n">StateFn</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OperatorMeasurement(Z)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OperatorStateFn(PauliOp(Pauli(&#39;Z&#39;), coeff=1.0), coeff=1.0, is_measurement=True)
</pre></div></div>
</div>
<p>Here, we compute <span class="math notranslate nohighlight">\(\langle 0 | Z | 0 \rangle\)</span>, <span class="math notranslate nohighlight">\(\langle 1 | Z | 1 \rangle\)</span>, and <span class="math notranslate nohighlight">\(\langle + | Z | + \rangle\)</span>, where <span class="math notranslate nohighlight">\(|+\rangle = (|0\rangle + |1\rangle)/\sqrt{2}\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">StateFn</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">Zero</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">StateFn</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">One</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">StateFn</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">Plus</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1+0j)
(-1+0j)
0j
</pre></div></div>
</div>
</section>
</section>
<section id="Part-IV:-Converters">
<h2>Part IV: Converters<a class="headerlink" href="#Part-IV:-Converters" title="永久链接至标题">¶</a></h2>
<p>Converters are classes that manipulate operators and states and perform building blocks of algorithms. Examples include changing the basis of operators and Trotterization. Converters traverse an expression and perform a particular manipulation or replacement, defined by the converter’s <code class="docutils literal notranslate"><span class="pre">convert()</span></code> method, of the Operators within. Typically, if a converter encounters an <code class="docutils literal notranslate"><span class="pre">OperatorBase</span></code> in the recursion which is irrelevant to its conversion purpose, that <code class="docutils literal notranslate"><span class="pre">OperatorBase</span></code> is left unchanged.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qiskit.opflow</span> <span class="kn">import</span> <span class="n">I</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">CX</span><span class="p">,</span> <span class="n">Zero</span><span class="p">,</span> <span class="n">ListOp</span><span class="p">,</span> <span class="n">PauliExpectation</span><span class="p">,</span> <span class="n">PauliTrotterEvolution</span><span class="p">,</span> <span class="n">CircuitSampler</span><span class="p">,</span> <span class="n">MatrixEvolution</span><span class="p">,</span> <span class="n">Suzuki</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit</span> <span class="kn">import</span> <span class="n">Parameter</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">Aer</span>
</pre></div>
</div>
</div>
<section id="Evolutions,-exp_i(),-and-the-EvolvedOp">
<h3>Evolutions, <code class="docutils literal notranslate"><span class="pre">exp_i()</span></code>, and the <code class="docutils literal notranslate"><span class="pre">EvolvedOp</span></code><a class="headerlink" href="#Evolutions,-exp_i(),-and-the-EvolvedOp" title="永久链接至标题">¶</a></h3>
<p>Every <code class="docutils literal notranslate"><span class="pre">PrimitiveOp</span></code> and <code class="docutils literal notranslate"><span class="pre">ListOp</span></code> has an <code class="docutils literal notranslate"><span class="pre">.exp_i()</span></code> function such that <code class="docutils literal notranslate"><span class="pre">H.exp_i()</span></code> corresponds to <span class="math notranslate nohighlight">\(e^{-iH}\)</span>. In practice, only a few of these Operators have an efficiently computable exponentiation (such as MatrixOp and the PauliOps with only one non-identity single-qubit Pauli), so we need to return a placeholder, or symbolic representation, (similar to how <code class="docutils literal notranslate"><span class="pre">SummedOp</span></code> is a placeholder when we can’t perform addition). This placeholder is called <code class="docutils literal notranslate"><span class="pre">EvolvedOp</span></code>, and it holds the
<code class="docutils literal notranslate"><span class="pre">OperatorBase</span></code> to be exponentiated in its <code class="docutils literal notranslate"><span class="pre">.primitive</span></code> property.</p>
<p>Qiskit operators fully support parameterization, so we can use a <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> for our evolution time here. Notice that there’s no “evolution time” argument in any function. The Operator flow exponentiates whatever operator we tell it to, and if we choose to multiply the operator by an evolution time, <span class="math notranslate nohighlight">\(e^{-iHt}\)</span>, that will be reflected in our exponentiation parameters.</p>
<section id="Weighted-sum-of-Pauli-operators">
<h4>Weighted sum of Pauli operators<a class="headerlink" href="#Weighted-sum-of-Pauli-operators" title="永久链接至标题">¶</a></h4>
<p>A Hamiltonian expressed as a linear combination of multi-qubit Pauli operators may be constructed like this.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">two_qubit_H2</span> <span class="o">=</span>  <span class="p">(</span><span class="o">-</span><span class="mf">1.0523732</span> <span class="o">*</span> <span class="n">I</span><span class="o">^</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> \
                <span class="p">(</span><span class="mf">0.39793742</span> <span class="o">*</span> <span class="n">I</span><span class="o">^</span><span class="n">Z</span><span class="p">)</span> <span class="o">+</span> \
                <span class="p">(</span><span class="o">-</span><span class="mf">0.3979374</span> <span class="o">*</span> <span class="n">Z</span><span class="o">^</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> \
                <span class="p">(</span><span class="o">-</span><span class="mf">0.0112801</span> <span class="o">*</span> <span class="n">Z</span><span class="o">^</span><span class="n">Z</span><span class="p">)</span> <span class="o">+</span> \
                <span class="p">(</span><span class="mf">0.18093119</span> <span class="o">*</span> <span class="n">X</span><span class="o">^</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">two_qubit_H2</span></code> is represented as a <code class="docutils literal notranslate"><span class="pre">SummedOp</span></code> whose terms are <code class="docutils literal notranslate"><span class="pre">PauliOp</span></code>s.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">two_qubit_H2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-1.0523732 * II
+ 0.39793742 * IZ
- 0.3979374 * ZI
- 0.0112801 * ZZ
+ 0.18093119 * XX
</pre></div></div>
</div>
<p>Next, we multiply the Hamiltonian by a <code class="docutils literal notranslate"><span class="pre">Parameter</span></code>. This <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> is stored in the <code class="docutils literal notranslate"><span class="pre">coeff</span></code> property of the <code class="docutils literal notranslate"><span class="pre">SummedOp</span></code>. Calling <code class="docutils literal notranslate"><span class="pre">exp_i()</span></code> on the result wraps it in <code class="docutils literal notranslate"><span class="pre">EvolvedOp</span></code>, representing exponentiation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">evo_time</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;θ&#39;</span><span class="p">)</span>
<span class="n">evolution_op</span> <span class="o">=</span> <span class="p">(</span><span class="n">evo_time</span><span class="o">*</span><span class="n">two_qubit_H2</span><span class="p">)</span><span class="o">.</span><span class="n">exp_i</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">evolution_op</span><span class="p">)</span> <span class="c1"># Note, EvolvedOps print as exponentiations</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">evolution_op</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
e^(-i*1.0*θ * (
  -1.0523732 * II
  + 0.39793742 * IZ
  - 0.3979374 * ZI
  - 0.0112801 * ZZ
  + 0.18093119 * XX
))
EvolvedOp(PauliSumOp(SparsePauliOp([[False, False, False, False],
               [False, False,  True, False],
               [False, False, False,  True],
               [False, False,  True,  True],
               [ True,  True, False, False]],
              coeffs=[-1.0523732 +0.j,  0.39793742+0.j, -0.3979374 +0.j, -0.0112801 +0.j,
  0.18093119+0.j]), coeff=1.0*θ), coeff=1.0)
</pre></div></div>
</div>
<p>We construct <code class="docutils literal notranslate"><span class="pre">h2_measurement</span></code>, which represents <code class="docutils literal notranslate"><span class="pre">two_qubit_H2</span></code> as an observable.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h2_measurement</span> <span class="o">=</span> <span class="n">StateFn</span><span class="p">(</span><span class="n">two_qubit_H2</span><span class="p">)</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">h2_measurement</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OperatorMeasurement(-1.0523732 * II
+ 0.39793742 * IZ
- 0.3979374 * ZI
- 0.0112801 * ZZ
+ 0.18093119 * XX)
</pre></div></div>
</div>
<p>We construct a Bell state <span class="math notranslate nohighlight">\(|\Phi_+\rangle\)</span> via <span class="math notranslate nohighlight">\(\text{CX} (H\otimes I) |00\rangle\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bell</span> <span class="o">=</span> <span class="n">CX</span> <span class="o">@</span> <span class="p">(</span><span class="n">I</span> <span class="o">^</span> <span class="n">H</span><span class="p">)</span> <span class="o">@</span> <span class="n">Zero</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CircuitStateFn(
     ┌───┐
q_0: ┤ H ├──■──
     └───┘┌─┴─┐
q_1: ─────┤ X ├
          └───┘
)
</pre></div></div>
</div>
<p>Here is the expression <span class="math notranslate nohighlight">\(H e^{-iHt} |\Phi_+\rangle\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">evo_and_meas</span> <span class="o">=</span> <span class="n">h2_measurement</span> <span class="o">@</span> <span class="n">evolution_op</span> <span class="o">@</span> <span class="n">bell</span>
<span class="nb">print</span><span class="p">(</span><span class="n">evo_and_meas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ComposedOp([
  OperatorMeasurement(-1.0523732 * II
  + 0.39793742 * IZ
  - 0.3979374 * ZI
  - 0.0112801 * ZZ
  + 0.18093119 * XX),
  e^(-i*1.0*θ * (
    -1.0523732 * II
    + 0.39793742 * IZ
    - 0.3979374 * ZI
    - 0.0112801 * ZZ
    + 0.18093119 * XX
  )),
  CircuitStateFn(
       ┌───┐
  q_0: ┤ H ├──■──
       └───┘┌─┴─┐
  q_1: ─────┤ X ├
            └───┘
  )
])
</pre></div></div>
</div>
<p>Typically, we want to approximate <span class="math notranslate nohighlight">\(e^{-iHt}\)</span> using two-qubit gates. We achieve this with the <code class="docutils literal notranslate"><span class="pre">convert</span></code> method of <code class="docutils literal notranslate"><span class="pre">PauliTrotterEvolution</span></code>, which traverses expressions applying trotterization to all <code class="docutils literal notranslate"><span class="pre">EvolvedOp</span></code>s encountered. Although we use <code class="docutils literal notranslate"><span class="pre">PauliTrotterEvolution</span></code> here, there are other possibilities, such as <code class="docutils literal notranslate"><span class="pre">MatrixEvolution</span></code>, which performs the exponentiation exactly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">trotterized_op</span> <span class="o">=</span> <span class="n">PauliTrotterEvolution</span><span class="p">(</span><span class="n">trotter_mode</span><span class="o">=</span><span class="n">Suzuki</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">evo_and_meas</span><span class="p">)</span>
<span class="c1"># We can also set trotter_mode=&#39;suzuki&#39; or leave it empty to default to first order Trotterization.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trotterized_op</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ComposedOp([
  OperatorMeasurement(-1.0523732 * II
  + 0.39793742 * IZ
  - 0.3979374 * ZI
  - 0.0112801 * ZZ
  + 0.18093119 * XX),
  CircuitStateFn(
  global phase: 1.0523732*θ
       ┌───┐     ┌───┐┌───┐┌──────────────────┐┌───┐┌───┐┌───┐»
  q_0: ┤ H ├──■──┤ H ├┤ X ├┤ RZ(0.18093119*θ) ├┤ X ├┤ H ├┤ X ├»
       └───┘┌─┴─┐├───┤└─┬─┘└──────────────────┘└─┬─┘├───┤└─┬─┘»
  q_1: ─────┤ X ├┤ H ├──■────────────────────────■──┤ H ├──■──»
            └───┘└───┘                              └───┘     »
  «     ┌──────────────────┐┌───┐┌──────────────────┐┌──────────────────┐┌───┐»
  «q_0: ┤ RZ(-0.0112801*θ) ├┤ X ├┤ RZ(0.39793742*θ) ├┤ RZ(0.39793742*θ) ├┤ X ├»
  «     └──────────────────┘└─┬─┘├──────────────────┤├──────────────────┤└─┬─┘»
  «q_1: ──────────────────────■──┤ RZ(-0.3979374*θ) ├┤ RZ(-0.3979374*θ) ├──■──»
  «                              └──────────────────┘└──────────────────┘     »
  «     ┌──────────────────┐┌───┐┌───┐┌───┐┌──────────────────┐┌───┐┌───┐
  «q_0: ┤ RZ(-0.0112801*θ) ├┤ X ├┤ H ├┤ X ├┤ RZ(0.18093119*θ) ├┤ X ├┤ H ├
  «     └──────────────────┘└─┬─┘├───┤└─┬─┘└──────────────────┘└─┬─┘├───┤
  «q_1: ──────────────────────■──┤ H ├──■────────────────────────■──┤ H ├
  «                              └───┘                              └───┘
  )
])
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">trotterized_op</span></code> contains a <code class="docutils literal notranslate"><span class="pre">Parameter</span></code>. The <code class="docutils literal notranslate"><span class="pre">bind_parameters</span></code> method traverses the expression binding values to parameter names as specified via a <code class="docutils literal notranslate"><span class="pre">dict</span></code>. In this case, there is only one parameter.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bound</span> <span class="o">=</span> <span class="n">trotterized_op</span><span class="o">.</span><span class="n">bind_parameters</span><span class="p">({</span><span class="n">evo_time</span><span class="p">:</span> <span class="mf">.5</span><span class="p">})</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">bound</span></code> is a <code class="docutils literal notranslate"><span class="pre">ComposedOp</span></code>. The second factor is the circuit. Let’s draw it to verify that the binding has taken place.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_circuit</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<pre style="word-wrap: normal;white-space: pre;background: #fff0;line-height: 1.1;font-family: &quot;Courier New&quot;,Courier,monospace">global phase: 0.52619
     ┌───┐     ┌───┐┌───┐┌────────────────────────┐┌───┐┌───┐┌───┐»
q_0: ┤ H ├──■──┤ H ├┤ X ├┤ RZ(0.0904655950000000) ├┤ X ├┤ H ├┤ X ├»
     └───┘┌─┴─┐├───┤└─┬─┘└────────────────────────┘└─┬─┘├───┤└─┬─┘»
q_1: ─────┤ X ├┤ H ├──■──────────────────────────────■──┤ H ├──■──»
          └───┘└───┘                                    └───┘     »
«     ┌──────────────────────────┐┌───┐┌───────────────────────┐ »
«q_0: ┤ RZ(-0.00564005000000000) ├┤ X ├┤ RZ(0.198968710000000) ├─»
«     └──────────────────────────┘└─┬─┘├───────────────────────┴┐»
«q_1: ──────────────────────────────■──┤ RZ(-0.198968700000000) ├»
«                                      └────────────────────────┘»
«     ┌───────────────────────┐ ┌───┐┌──────────────────────────┐┌───┐┌───┐»
«q_0: ┤ RZ(0.198968710000000) ├─┤ X ├┤ RZ(-0.00564005000000000) ├┤ X ├┤ H ├»
«     ├───────────────────────┴┐└─┬─┘└──────────────────────────┘└─┬─┘├───┤»
«q_1: ┤ RZ(-0.198968700000000) ├──■────────────────────────────────■──┤ H ├»
«     └────────────────────────┘                                      └───┘»
«     ┌───┐┌────────────────────────┐┌───┐┌───┐
«q_0: ┤ X ├┤ RZ(0.0904655950000000) ├┤ X ├┤ H ├
«     └─┬─┘└────────────────────────┘└─┬─┘├───┤
«q_1: ──■──────────────────────────────■──┤ H ├
«                                         └───┘</pre></div>
</div>
</section>
</section>
<section id="Expectations">
<h3>Expectations<a class="headerlink" href="#Expectations" title="永久链接至标题">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Expectation</span></code>s are converters that enable the computation of expectation values of observables. They traverse an Operator tree, replacing <code class="docutils literal notranslate"><span class="pre">OperatorStateFn</span></code>s (observables) with equivalent instructions which are more amenable to computation on quantum or classical hardware. For example, if we want to measure the expectation value of an Operator <code class="docutils literal notranslate"><span class="pre">o</span></code> expressed as a sum of Paulis with respect to some state function, but can only access diagonal measurements on quantum hardware, we can
create an observable <code class="docutils literal notranslate"><span class="pre">~StateFn(o)</span></code> and use a <code class="docutils literal notranslate"><span class="pre">PauliExpectation</span></code> to convert it to a diagonal measurement and circuit pre-rotations to append to the state.</p>
<p>Another interesting <code class="docutils literal notranslate"><span class="pre">Expectation</span></code> is the <code class="docutils literal notranslate"><span class="pre">AerPauliExpectation</span></code>, which converts the observable into a <code class="docutils literal notranslate"><span class="pre">CircuitStateFn</span></code> containing a special expectation snapshot instruction which <code class="docutils literal notranslate"><span class="pre">Aer</span></code> can execute natively with high performance.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Note that XX was the only non-diagonal measurement in our H2 Observable</span>
<span class="nb">print</span><span class="p">(</span><span class="n">PauliExpectation</span><span class="p">(</span><span class="n">group_paulis</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">h2_measurement</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SummedOp([
  ComposedOp([
    OperatorMeasurement(-1.0523732 * II),
    II
  ]),
  ComposedOp([
    OperatorMeasurement(0.39793742 * IZ),
    II
  ]),
  ComposedOp([
    OperatorMeasurement(-0.3979374 * ZI),
    II
  ]),
  ComposedOp([
    OperatorMeasurement(-0.0112801 * ZZ),
    II
  ]),
  ComposedOp([
    OperatorMeasurement(0.18093119 * ZZ),
         ┌───┐
    q_0: ┤ H ├
         ├───┤
    q_1: ┤ H ├
         └───┘
  ])
])
</pre></div></div>
</div>
<p>By default <code class="docutils literal notranslate"><span class="pre">group_paulis=True</span></code>, which will use the <code class="docutils literal notranslate"><span class="pre">AbelianGrouper</span></code> to convert the <code class="docutils literal notranslate"><span class="pre">SummedOp</span></code> into groups of mutually qubit-wise commuting Paulis. This reduces circuit execution overhead, as each group can share the same circuit execution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">PauliExpectation</span><span class="p">()</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">h2_measurement</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SummedOp([
  ComposedOp([
    OperatorMeasurement(-0.3979374 * ZI
    - 0.0112801 * ZZ
    + 0.39793742 * IZ),
    II
  ]),
  ComposedOp([
    OperatorMeasurement(-1.0523732 * II
    + 0.18093119 * ZZ),
         ┌───┐
    q_0: ┤ H ├
         ├───┤
    q_1: ┤ H ├
         └───┘
  ])
])
</pre></div></div>
</div>
<p>Note that converters act recursively, that is, they traverse an expression applying their action only where possible. So we can just convert our full evolution and measurement expression. We could have equivalently composed the converted <code class="docutils literal notranslate"><span class="pre">h2_measurement</span></code> with our evolution <code class="docutils literal notranslate"><span class="pre">CircuitStateFn</span></code>. We proceed by applying the conversion on the entire expression.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diagonalized_meas_op</span> <span class="o">=</span> <span class="n">PauliExpectation</span><span class="p">()</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">trotterized_op</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diagonalized_meas_op</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SummedOp([
  ComposedOp([
    OperatorMeasurement(-1.0523732 * II
    + 0.18093119 * ZZ),
    CircuitStateFn(
    global phase: 1.0523732*θ
         ┌───┐     ┌───┐┌───┐┌──────────────────┐┌───┐┌───┐┌───┐»
    q_0: ┤ H ├──■──┤ H ├┤ X ├┤ RZ(0.18093119*θ) ├┤ X ├┤ H ├┤ X ├»
         └───┘┌─┴─┐├───┤└─┬─┘└──────────────────┘└─┬─┘├───┤└─┬─┘»
    q_1: ─────┤ X ├┤ H ├──■────────────────────────■──┤ H ├──■──»
              └───┘└───┘                              └───┘     »
    «     ┌──────────────────┐┌───┐┌──────────────────┐┌──────────────────┐┌───┐»
    «q_0: ┤ RZ(-0.0112801*θ) ├┤ X ├┤ RZ(0.39793742*θ) ├┤ RZ(0.39793742*θ) ├┤ X ├»
    «     └──────────────────┘└─┬─┘├──────────────────┤├──────────────────┤└─┬─┘»
    «q_1: ──────────────────────■──┤ RZ(-0.3979374*θ) ├┤ RZ(-0.3979374*θ) ├──■──»
    «                              └──────────────────┘└──────────────────┘     »
    «     ┌──────────────────┐┌───┐┌───┐┌───┐┌──────────────────┐┌───┐┌───┐┌───┐
    «q_0: ┤ RZ(-0.0112801*θ) ├┤ X ├┤ H ├┤ X ├┤ RZ(0.18093119*θ) ├┤ X ├┤ H ├┤ H ├
    «     └──────────────────┘└─┬─┘├───┤└─┬─┘└──────────────────┘└─┬─┘├───┤├───┤
    «q_1: ──────────────────────■──┤ H ├──■────────────────────────■──┤ H ├┤ H ├
    «                              └───┘                              └───┘└───┘
    )
  ]),
  ComposedOp([
    OperatorMeasurement(-0.0112801 * ZZ
    - 0.3979374 * ZI
    + 0.39793742 * IZ),
    CircuitStateFn(
    global phase: 1.0523732*θ
         ┌───┐     ┌───┐┌───┐┌──────────────────┐┌───┐┌───┐┌───┐»
    q_0: ┤ H ├──■──┤ H ├┤ X ├┤ RZ(0.18093119*θ) ├┤ X ├┤ H ├┤ X ├»
         └───┘┌─┴─┐├───┤└─┬─┘└──────────────────┘└─┬─┘├───┤└─┬─┘»
    q_1: ─────┤ X ├┤ H ├──■────────────────────────■──┤ H ├──■──»
              └───┘└───┘                              └───┘     »
    «     ┌──────────────────┐┌───┐┌──────────────────┐┌──────────────────┐┌───┐»
    «q_0: ┤ RZ(-0.0112801*θ) ├┤ X ├┤ RZ(0.39793742*θ) ├┤ RZ(0.39793742*θ) ├┤ X ├»
    «     └──────────────────┘└─┬─┘├──────────────────┤├──────────────────┤└─┬─┘»
    «q_1: ──────────────────────■──┤ RZ(-0.3979374*θ) ├┤ RZ(-0.3979374*θ) ├──■──»
    «                              └──────────────────┘└──────────────────┘     »
    «     ┌──────────────────┐┌───┐┌───┐┌───┐┌──────────────────┐┌───┐┌───┐
    «q_0: ┤ RZ(-0.0112801*θ) ├┤ X ├┤ H ├┤ X ├┤ RZ(0.18093119*θ) ├┤ X ├┤ H ├
    «     └──────────────────┘└─┬─┘├───┤└─┬─┘└──────────────────┘└─┬─┘├───┤
    «q_1: ──────────────────────■──┤ H ├──■────────────────────────■──┤ H ├
    «                              └───┘                              └───┘
    )
  ])
])
</pre></div></div>
</div>
<p>Now we bind multiple parameter values into a <code class="docutils literal notranslate"><span class="pre">ListOp</span></code>, followed by <code class="docutils literal notranslate"><span class="pre">eval</span></code> to evaluate the entire expression. We could have used <code class="docutils literal notranslate"><span class="pre">eval</span></code> earlier if we bound earlier, but it would not be efficient. Here, <code class="docutils literal notranslate"><span class="pre">eval</span></code> will convert our <code class="docutils literal notranslate"><span class="pre">CircuitStateFn</span></code>s to <code class="docutils literal notranslate"><span class="pre">VectorStateFn</span></code>s through simulation internally.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">evo_time_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="n">h2_trotter_expectations</span> <span class="o">=</span> <span class="n">diagonalized_meas_op</span><span class="o">.</span><span class="n">bind_parameters</span><span class="p">({</span><span class="n">evo_time</span><span class="p">:</span> <span class="n">evo_time_points</span><span class="p">})</span>
</pre></div>
</div>
</div>
<p>Here are the expectation values <span class="math notranslate nohighlight">\(\langle \Phi_+| e^{iHt} H e^{-iHt} |\Phi_+\rangle\)</span> corresponding to the different values of the parameter.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h2_trotter_expectations</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-0.88272211+0.0e+00j, -0.88272211+0.0e+00j, -0.88272211+0.0e+00j,
       -0.88272211+0.0e+00j, -0.88272211+0.0e+00j, -0.88272211+0.0e+00j,
       -0.88272211+5.6e-17j, -0.88272211+0.0e+00j])
</pre></div></div>
</div>
</section>
<section id="Executing-CircuitStateFns-with-the-CircuitSampler">
<h3>Executing <code class="docutils literal notranslate"><span class="pre">CircuitStateFn</span></code>s with the <code class="docutils literal notranslate"><span class="pre">CircuitSampler</span></code><a class="headerlink" href="#Executing-CircuitStateFns-with-the-CircuitSampler" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">CircuitSampler</span></code> traverses an Operator and converts any <code class="docutils literal notranslate"><span class="pre">CircuitStateFns</span></code> into approximations of the resulting state function by a <code class="docutils literal notranslate"><span class="pre">DictStateFn</span></code> or <code class="docutils literal notranslate"><span class="pre">VectorStateFn</span></code> using a quantum backend. Note that in order to approximate the value of the <code class="docutils literal notranslate"><span class="pre">CircuitStateFn</span></code>, it must 1) send the state function through a depolarizing channel, which will destroy all phase information and 2) replace the sampled frequencies with <strong>square roots</strong> of the frequency, rather than the raw probability of
sampling (which would be the equivalent of sampling the <strong>square</strong> of the state function, per the Born rule.)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sampler</span> <span class="o">=</span> <span class="n">CircuitSampler</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;aer_simulator&#39;</span><span class="p">))</span>
<span class="c1"># sampler.quantum_instance.run_config.shots = 1000</span>
<span class="n">sampled_trotter_exp_op</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">h2_trotter_expectations</span><span class="p">)</span>
<span class="n">sampled_trotter_energies</span> <span class="o">=</span> <span class="n">sampled_trotter_exp_op</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sampled Trotterized energies:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">sampled_trotter_energies</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Sampled Trotterized energies:
 [-0.88272211 -0.88272211 -0.88272211 -0.88272211 -0.88272211 -0.88272211
 -0.88272211 -0.88272211]
</pre></div></div>
</div>
<p>Note again that the circuits are replaced by dicts with <strong>square roots</strong> of the circuit sampling probabilities. Take a look at one sub-expression before and after the conversion:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Before:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">h2_trotter_expectations</span><span class="o">.</span><span class="n">reduce</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">After:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sampled_trotter_exp_op</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Before:

ComposedOp([
  OperatorMeasurement(-1.0523732 * II
  + 0.18093119 * ZZ),
  CircuitStateFn(
       ┌───┐     ┌───┐┌───┐┌───────┐┌───┐┌───┐┌───┐┌───────┐┌───┐┌───────┐»
  q_0: ┤ H ├──■──┤ H ├┤ X ├┤ RZ(0) ├┤ X ├┤ H ├┤ X ├┤ RZ(0) ├┤ X ├┤ RZ(0) ├»
       └───┘┌─┴─┐├───┤└─┬─┘└───────┘└─┬─┘├───┤└─┬─┘└───────┘└─┬─┘├───────┤»
  q_1: ─────┤ X ├┤ H ├──■─────────────■──┤ H ├──■─────────────■──┤ RZ(0) ├»
            └───┘└───┘                   └───┘                   └───────┘»
  «     ┌───────┐┌───┐┌───────┐┌───┐┌───┐┌───┐┌───────┐┌───┐┌───┐┌───┐
  «q_0: ┤ RZ(0) ├┤ X ├┤ RZ(0) ├┤ X ├┤ H ├┤ X ├┤ RZ(0) ├┤ X ├┤ H ├┤ H ├
  «     ├───────┤└─┬─┘└───────┘└─┬─┘├───┤└─┬─┘└───────┘└─┬─┘├───┤├───┤
  «q_1: ┤ RZ(0) ├──■─────────────■──┤ H ├──■─────────────■──┤ H ├┤ H ├
  «     └───────┘                   └───┘                   └───┘└───┘
  )
])

After:

ComposedOp([
  OperatorMeasurement(-1.0523732 * II
  + 0.18093119 * ZZ),
  DictStateFn({&#39;00&#39;: 0.7228145941387736, &#39;11&#39;: 0.6910420121092494})
])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">qiskit.tools.jupyter</span>
<span class="o">%</span><span class="k">qiskit_version_table</span>
<span class="o">%</span><span class="k">qiskit_copyright</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<h3>Version Information</h3><table><tr><th>Qiskit Software</th><th>Version</th></tr><tr><td>Qiskit</td><td>None</td></tr><tr><td>Terra</td><td>0.18.0.dev0+5920b66</td></tr><tr><td>Aer</td><td>0.9.0</td></tr><tr><td>Ignis</td><td>0.7.0.dev0+8195559</td></tr><tr><td>Aqua</td><td>None</td></tr><tr><td>IBM Q Provider</td><td>None</td></tr><tr><th>System information</th></tr><tr><td>Python</td><td>3.8.8 (default, Apr 13 2021, 12:59:45)
[Clang 10.0.0 ]</td></tr><tr><td>OS</td><td>Darwin</td></tr><tr><td>CPUs</td><td>2</td></tr><tr><td>Memory (Gb)</td><td>12.0</td></tr><tr><td colspan='2'>Thu May 27 11:06:21 2021 EDT</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style='width: 100%; background-color:#d5d9e0;padding-left: 10px; padding-bottom: 10px; padding-right: 10px; padding-top: 5px'><h3>This code is a part of Qiskit</h3><p>&copy; Copyright IBM 2017, 2021.</p><p>This code is licensed under the Apache License, Version 2.0. You may<br>obtain a copy of this license in the LICENSE.txt file in the root directory<br> of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.<p>Any modifications or derivative works of this code must retain this<br>copyright notice, and modified files need to carry a notice indicating<br>that they have been altered from the originals.</p></div></div>
</div>
</section>
</section>
</section>


             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Qiskit Development Team.
      最后更新于 2021/07/08.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Operator Flow</a><ul>
<li><a class="reference internal" href="#Introduction">Introduction</a><ul>
<li><a class="reference internal" href="#Pauli-operators,-sums,-compositions,-and-tensor-products">Pauli operators, sums, compositions, and tensor products</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Part-I:-State-Functions-and-Measurements">Part I: State Functions and Measurements</a><ul>
<li><a class="reference internal" href="#Algebraic-operations-and-predicates">Algebraic operations and predicates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Part-II:-PrimitiveOps">Part II: <code class="docutils literal notranslate"><span class="pre">PrimitiveOp</span></code>s</a><ul>
<li><a class="reference internal" href="#Matrix-elements">Matrix elements</a></li>
<li><a class="reference internal" href="#Applying-an-operator-to-a-state-vector">Applying an operator to a state vector</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Part-III-ListOp-and-subclasses">Part III <code class="docutils literal notranslate"><span class="pre">ListOp</span></code> and subclasses</a><ul>
<li><a class="reference internal" href="#ListOp"><code class="docutils literal notranslate"><span class="pre">ListOp</span></code></a></li>
<li><a class="reference internal" href="#ListOps:-SummedOp,-ComposedOp,-TensoredOp"><code class="docutils literal notranslate"><span class="pre">ListOp</span></code>s: <code class="docutils literal notranslate"><span class="pre">SummedOp</span></code>, <code class="docutils literal notranslate"><span class="pre">ComposedOp</span></code>, <code class="docutils literal notranslate"><span class="pre">TensoredOp</span></code></a></li>
<li><a class="reference internal" href="#OperatorStateFn"><code class="docutils literal notranslate"><span class="pre">OperatorStateFn</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#Part-IV:-Converters">Part IV: Converters</a><ul>
<li><a class="reference internal" href="#Evolutions,-exp_i(),-and-the-EvolvedOp">Evolutions, <code class="docutils literal notranslate"><span class="pre">exp_i()</span></code>, and the <code class="docutils literal notranslate"><span class="pre">EvolvedOp</span></code></a><ul>
<li><a class="reference internal" href="#Weighted-sum-of-Pauli-operators">Weighted sum of Pauli operators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Expectations">Expectations</a></li>
<li><a class="reference internal" href="#Executing-CircuitStateFns-with-the-CircuitSampler">Executing <code class="docutils literal notranslate"><span class="pre">CircuitStateFn</span></code>s with the <code class="docutils literal notranslate"><span class="pre">CircuitSampler</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
         <script src="../../_static/jquery.js"></script>
         <script src="../../_static/underscore.js"></script>
         <script src="../../_static/doctools.js"></script>
         <script src="../../_static/language_data.js"></script>
         <script src="../../_static/thebelab-helper.js"></script>
         <script src="../../_static/translations.js"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^0.21.0-alpha.0/dist/embed-amd.js"></script>
         <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
         <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
     

  

  <script type="text/javascript" src="../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <div>
    <br>
  </div>

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="../../getting_started.html">Getting Started</a>
          </li>
          <li>
            <a href="../../tutorials.html">Tutorials</a>
          </li>
          <li>
            <a href="https://qiskit.org/documentation/partners/">Providers</a>
          </li>
          <br>
          <li class="resources-mobile-menu-title">
            Applications
          </li>
          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://qiskit.org/documentation/machine-learning/">Machine learning</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/nature/">Nature</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/finance/">Finance</a>
            </li>

            <li>
              <a href="https://qiskit.org/documentation/optimization/">Optimization</a>
            </li>
          </ul>

          <br>

          <li class="resources-mobile-menu-title">
            Resources
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://qiskit.slack.com">Slack support</a>
            </li>
          </ul>
          <br>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>