

<!DOCTYPE html>
<html class="writer-html5" lang="es-ES" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quantum Tomography &mdash; documentación de Qiskit - 0.22.0</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme-override.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0-alpha.0/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Entanglement Verification" href="9_entanglement_verification.html" />
    <link rel="prev" title="Accreditation protocol" href="7_accreditation.html" />
    <script>
    (function () {
      'use strict'
      window._analytics = {
        segment_key: 'ffdYLviQze3kzomaINXNk6NwpY9LlXcw',
        coremetrics: false,
        optimizely: false,
        googleAddServices: false,
        fullStory: false,
        autoPageEventSpa: false,
        autoFormEvents: false,
        autoPageView: false
      }

      window.digitalData = {
        page: {
          pageInfo: {
            productTitle: 'IBM Q Experience',
            analytics: {
              category: 'Qiskit.org'
            }
          }
        }
      }

      window._analyticsReady = window._analyticsReady || new Promise((resolve) => {
        const script = document.createElement('script')
        script.async = true
        script.src = 'https://cloud.ibm.com/analytics/build/bluemix-analytics.min.js'
        document.head.appendChild(script)
        script.onload = resolve
        script.onerror = (err) => {
          console.warn('Error loading Bluemix Analytics script:', err)
          resolve()
        }
      })

      window._analyticsReady.then(() => {
        if (!window.bluemixAnalytics || !window.digitalData) { return }

        const category = window.digitalData.page.pageInfo.analytics.category
        const productTitle = window.digitalData.page.pageInfo.productTitle
        const routeName = 'api-documentation'

        window.bluemixAnalytics.pageEvent(category, routeName, {
          navigationType: 'pushState',
          productTitle: productTitle,
          title: document.title
        })
      })
    }());
    </script>
     

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #212121" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Qiskit
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Instalando Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Primeros pasos con Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../the_elements.html">Los Elementos de Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development_strategy.html">Development Strategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing_to_qiskit.html">Contribuir a Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Local Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../circuits/index.html">Circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../circuits_advanced/index.html">Advanced Circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pulse/index.html">Pulse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulators/index.html">High-Performance Simulators</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Quantum System Error Analysis</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_hamiltonian_and_gate_characterization.html">Hamiltonian and Gate Characterization</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_relaxation_and_decoherence.html"><em>Relaxation and Decoherence</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="3_measurement_error_mitigation.html">Measurement Error Mitigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_randomized_benchmarking.html">Randomized Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_quantum_volume.html">Quantum Volume</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_repetition_code.html">Repetition Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_accreditation.html">Accreditation protocol</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Quantum Tomography</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Initial-examples">Initial examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#2-Qubit-state-tomography-Example">2-Qubit state tomography Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Repeat-the-Example-with-Measurement-Noise">Repeat the Example with Measurement Noise</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#1-qubit-process-tomography-example">1-qubit process tomography example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#1-qubit-process-tomography-of-two-qubit-swap-gate">1-qubit process tomography of two-qubit swap gate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Advances-examples">Advances examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Generating-and-fitting-random-states">Generating and fitting random states</a></li>
<li class="toctree-l3"><a class="reference internal" href="#5-Qubit-Bell-State">5-Qubit Bell State</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2-Qubit-Conditional-State-Tomography">2-Qubit Conditional State Tomography</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Gate-set-tomography">Gate set tomography</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1-Qubit-gate-set-tomography-Examples">1-Qubit gate set tomography Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Noiseless-1-qubit-gate-set-tomography">Noiseless 1-qubit gate set tomography</a></li>
<li class="toctree-l4"><a class="reference internal" href="#1-qubit-gate-set-tomography-with-amplitude-damping-noise">1-qubit gate set tomography with amplitude damping noise</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="9_entanglement_verification.html">Entanglement Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="9_entanglement_verification.html#Parallelizing-circuits">Parallelizing circuits</a></li>
<li class="toctree-l2"><a class="reference internal" href="9_entanglement_verification.html#Error-Mitigation">Error Mitigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="9_entanglement_verification.html#Experiment-Time">Experiment Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="9_entanglement_verification.html#Conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../optimization/index.html">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../finance/index.html">Finance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chemistry/index.html">Chemistry</a></li>
</ul>
<p class="caption"><span class="caption-text">Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/circuit_library.html">Circuit Library</a></li>
</ul>
<p class="caption"><span class="caption-text">Referencia de la API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/terra.html">Qiskit Terra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/aer.html">Qiskit Aer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ignis.html">Qiskit Ignis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/aqua.html">Qiskit Aqua</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ibmq-provider.html">Qiskit IBM Quantum Provider</a></li>
</ul>
<p class="caption"><span class="caption-text">Troubleshooting</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://quantum-computing.ibm.com/docs/cloud/errors">Quantum Experience API error codes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Qiskit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Quantum System Error Analysis Tutorials</a> &raquo;</li>
        
      <li>Quantum Tomography</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/noise/8_tomography.ipynb" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>This page was generated from <a class="reference external" href="https://github.com/Qiskit/qiskit-tutorials/blob/master/tutorials/noise/8_tomography.ipynb">tutorials/noise/8_tomography.ipynb</a>.</p>
</div>
<p><a href="#id2"><span class="problematic" id="id3">|qiskit\_header.png|</span></a></p>
<div class="section" id="Quantum-Tomography">
<h1>Quantum Tomography<a class="headerlink" href="#Quantum-Tomography" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Quantum tomography is an experimental procedure to reconstruct a description of part of quantum system from the measurement outcomes of a specific set of experiments. In Qiskit we implement the following types of tomography:</p>
<ol class="arabic simple">
<li><p><strong>Quantum state tomography</strong>: Given a state-preparation circuit that prepares a system in a state, reconstruct a description of the density matrix <span class="math notranslate nohighlight">\(\rho\)</span> of the actual state obtained in the system.</p></li>
<li><p><strong>Quantum process tomograhpy</strong>: Given a circuit, reconstruct a description of the quantum channel <span class="math notranslate nohighlight">\(\mathcal{E}\)</span> that describes the circuit’s operator when running on the system.</p></li>
<li><p><strong>Quantum gate set tomography</strong>: Performs process tomography on a set of gates in a self-consistant manner, meaning quantum noises on gates used by the tomography process itself is also taken into account.</p></li>
</ol>
<p>This notebook gives examples for how to use the <code class="docutils literal notranslate"><span class="pre">ignis.verification.tomography</span></code> modules.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Needed for functions</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>

<span class="c1"># Import Qiskit classes</span>
<span class="kn">import</span> <span class="nn">qiskit</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">QuantumRegister</span><span class="p">,</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">ClassicalRegister</span><span class="p">,</span> <span class="n">Aer</span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">state_fidelity</span><span class="p">,</span> <span class="n">process_fidelity</span>
<span class="kn">from</span> <span class="nn">qiskit.providers.aer</span> <span class="kn">import</span> <span class="n">noise</span>
<span class="kn">from</span> <span class="nn">qiskit.compiler</span> <span class="kn">import</span> <span class="n">assemble</span>

<span class="c1"># Tomography functions</span>
<span class="kn">from</span> <span class="nn">qiskit.ignis.verification.tomography</span> <span class="kn">import</span> <span class="n">state_tomography_circuits</span><span class="p">,</span> <span class="n">StateTomographyFitter</span>
<span class="kn">from</span> <span class="nn">qiskit.ignis.verification.tomography</span> <span class="kn">import</span> <span class="n">process_tomography_circuits</span><span class="p">,</span> <span class="n">ProcessTomographyFitter</span>
<span class="kn">from</span> <span class="nn">qiskit.ignis.verification.tomography</span> <span class="kn">import</span> <span class="n">gateset_tomography_circuits</span><span class="p">,</span> <span class="n">GatesetTomographyFitter</span>
<span class="kn">import</span> <span class="nn">qiskit.ignis.mitigation.measurement</span> <span class="k">as</span> <span class="nn">mc</span>

<span class="c1"># Auxiliary methods</span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">Choi</span><span class="p">,</span> <span class="n">Kraus</span>
<span class="kn">from</span> <span class="nn">qiskit.extensions</span> <span class="kn">import</span> <span class="n">HGate</span><span class="p">,</span> <span class="n">XGate</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Initial-examples">
<h2>Initial examples<a class="headerlink" href="#Initial-examples" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="2-Qubit-state-tomography-Example">
<h3>2-Qubit state tomography Example<a class="headerlink" href="#2-Qubit-state-tomography-Example" title="Enlazar permanentemente con este título">¶</a></h3>
<p>In the below example we want to perform state tomography on a 2Q Bell state between qubits 3 and 5. To make the reference circuit we generate the expected statevector using <code class="docutils literal notranslate"><span class="pre">statevector_simulator</span></code> between qubits 0 and 1.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create the expected density matrix</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">bell</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">q2</span><span class="p">)</span>
<span class="n">bell</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">bell</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bell</span><span class="p">)</span>

<span class="n">job</span> <span class="o">=</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">bell</span><span class="p">,</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;statevector_simulator&#39;</span><span class="p">))</span>
<span class="n">psi_bell</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_statevector</span><span class="p">(</span><span class="n">bell</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">psi_bell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
      ┌───┐
q0_0: ┤ H ├──■──
      └───┘┌─┴─┐
q0_1: ─────┤ X ├
           └───┘
[0.70710678+0.j 0.        +0.j 0.        +0.j 0.70710678+0.j]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create the actual circuit</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">bell</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">q2</span><span class="p">)</span>
<span class="n">bell</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q2</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">bell</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q2</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">q2</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

q3_0: ──────────

q3_1: ──────────

q3_2: ──────────
      ┌───┐
q3_3: ┤ H ├──■──
      └───┘  │
q3_4: ───────┼──
           ┌─┴─┐
q3_5: ─────┤ X ├
           └───┘
</pre></div></div>
</div>
<p>Here we are going to generate and run the state tomography circuits. By only passing in the 2 registers we want to measure the state tomography will only run on that reduced <span class="math notranslate nohighlight">\(2^2\)</span> Hilbert space. However, if we pass the whole register in the state tomography module will try and fit the full <span class="math notranslate nohighlight">\(2^6\)</span> space.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Generate circuits and run on simulator</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="c1"># Generate the state tomography circuits. Only pass in the</span>
<span class="c1"># registers we want to measure (in this case 3 and 5)</span>
<span class="n">qst_bell</span> <span class="o">=</span> <span class="n">state_tomography_circuits</span><span class="p">(</span><span class="n">bell</span><span class="p">,</span> <span class="p">[</span><span class="n">q2</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">q2</span><span class="p">[</span><span class="mi">5</span><span class="p">]])</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">qst_bell</span><span class="p">,</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time taken:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>

<span class="n">tomo_bell</span> <span class="o">=</span> <span class="n">StateTomographyFitter</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">qst_bell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Time taken: 0.028922557830810547
</pre></div></div>
</div>
<p>The fitter will output a density matrix ordered according to how we passed in the registers to <code class="docutils literal notranslate"><span class="pre">state_tomography_circuits</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Perform the tomography fit</span>
<span class="c1"># which outputs a density matrix</span>
<span class="n">rho_bell</span> <span class="o">=</span> <span class="n">tomo_bell</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">F_bell</span> <span class="o">=</span> <span class="n">state_fidelity</span><span class="p">(</span><span class="n">psi_bell</span><span class="p">,</span> <span class="n">rho_bell</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fit Fidelity =&#39;</span><span class="p">,</span> <span class="n">F_bell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FATAL: Cannot solve SDPs with &gt; 2x2 matrices without linked blas+lapack libraries
Install blas+lapack and re-compile SCS with blas+lapack library locations
ERROR: init_cone failure
Failure:could not initialize work
Fit Fidelity = 0.9960151819931408
</pre></div></div>
</div>
</div>
<div class="section" id="Repeat-the-Example-with-Measurement-Noise">
<h3>Repeat the Example with Measurement Noise<a class="headerlink" href="#Repeat-the-Example-with-Measurement-Noise" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Add measurement noise</span>
<span class="n">noise_model</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">NoiseModel</span><span class="p">()</span>
<span class="k">for</span> <span class="n">qi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">read_err</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">readout_error</span><span class="o">.</span><span class="n">ReadoutError</span><span class="p">([[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.9</span><span class="p">]])</span>
    <span class="n">noise_model</span><span class="o">.</span><span class="n">add_readout_error</span><span class="p">(</span><span class="n">read_err</span><span class="p">,[</span><span class="n">qi</span><span class="p">])</span>

<span class="c1">#generate the calibration circuits</span>
<span class="n">meas_calibs</span><span class="p">,</span> <span class="n">state_labels</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">complete_meas_cal</span><span class="p">(</span><span class="n">qubit_list</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

<span class="n">backend</span> <span class="o">=</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">)</span>
<span class="n">job_cal</span> <span class="o">=</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">meas_calibs</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">)</span>
<span class="n">job_tomo</span> <span class="o">=</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">qst_bell</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">)</span>

<span class="n">meas_fitter</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">CompleteMeasFitter</span><span class="p">(</span><span class="n">job_cal</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span><span class="n">state_labels</span><span class="p">)</span>

<span class="n">tomo_bell</span> <span class="o">=</span> <span class="n">StateTomographyFitter</span><span class="p">(</span><span class="n">job_tomo</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">qst_bell</span><span class="p">)</span>

<span class="c1">#no correction</span>
<span class="n">rho_bell</span> <span class="o">=</span> <span class="n">tomo_bell</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">F_bell</span> <span class="o">=</span> <span class="n">state_fidelity</span><span class="p">(</span><span class="n">psi_bell</span><span class="p">,</span> <span class="n">rho_bell</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fit Fidelity (no correction) =&#39;</span><span class="p">,</span> <span class="n">F_bell</span><span class="p">)</span>

<span class="c1">#correct data</span>
<span class="n">correct_tomo_results</span> <span class="o">=</span> <span class="n">meas_fitter</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">job_tomo</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;least_squares&#39;</span><span class="p">)</span>
<span class="n">tomo_bell</span> <span class="o">=</span> <span class="n">StateTomographyFitter</span><span class="p">(</span><span class="n">correct_tomo_results</span><span class="p">,</span> <span class="n">qst_bell</span><span class="p">)</span>
<span class="n">rho_bell</span> <span class="o">=</span> <span class="n">tomo_bell</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">F_bell</span> <span class="o">=</span> <span class="n">state_fidelity</span><span class="p">(</span><span class="n">psi_bell</span><span class="p">,</span> <span class="n">rho_bell</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fit Fidelity (w/ correction) =&#39;</span><span class="p">,</span> <span class="n">F_bell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Fit Fidelity (no correction) = 0.5728099462585374
Fit Fidelity (w/ correction) = 0.9756857354884931
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="1-qubit-process-tomography-example">
<h2>1-qubit process tomography example<a class="headerlink" href="#1-qubit-process-tomography-example" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Process tomography of a Hadamard gate</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Run circuit on unitary simulator to find ideal unitary</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;unitary_simulator&#39;</span><span class="p">))</span>
<span class="n">ideal_unitary</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_unitary</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>

<span class="c1"># convert to Choi-matrix in column-major convention</span>
<span class="n">vector_ideal</span> <span class="o">=</span> <span class="n">ideal_unitary</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
<span class="n">choi_ideal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">vector_ideal</span><span class="p">,</span> <span class="n">vector_ideal</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span>

<span class="c1"># Generate process tomography circuits and run on qasm simulator</span>
<span class="n">qpt_circs</span> <span class="o">=</span> <span class="n">process_tomography_circuits</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">qpt_circs</span><span class="p">,</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">4000</span><span class="p">)</span>

<span class="c1"># Extract tomography data so that counts are indexed by measurement configuration</span>
<span class="n">qpt_tomo</span> <span class="o">=</span> <span class="n">ProcessTomographyFitter</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">qpt_circs</span><span class="p">)</span>
<span class="n">qpt_tomo</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{((&#39;Zp&#39;,), (&#39;X&#39;,)): {&#39;0&#39;: 4000},
 ((&#39;Zp&#39;,), (&#39;Y&#39;,)): {&#39;0&#39;: 1998, &#39;1&#39;: 2002},
 ((&#39;Zp&#39;,), (&#39;Z&#39;,)): {&#39;0&#39;: 2047, &#39;1&#39;: 1953},
 ((&#39;Zm&#39;,), (&#39;X&#39;,)): {&#39;1&#39;: 4000},
 ((&#39;Zm&#39;,), (&#39;Y&#39;,)): {&#39;0&#39;: 1996, &#39;1&#39;: 2004},
 ((&#39;Zm&#39;,), (&#39;Z&#39;,)): {&#39;0&#39;: 1990, &#39;1&#39;: 2010},
 ((&#39;Xp&#39;,), (&#39;X&#39;,)): {&#39;0&#39;: 1978, &#39;1&#39;: 2022},
 ((&#39;Xp&#39;,), (&#39;Y&#39;,)): {&#39;0&#39;: 1992, &#39;1&#39;: 2008},
 ((&#39;Xp&#39;,), (&#39;Z&#39;,)): {&#39;0&#39;: 4000},
 ((&#39;Yp&#39;,), (&#39;X&#39;,)): {&#39;0&#39;: 1996, &#39;1&#39;: 2004},
 ((&#39;Yp&#39;,), (&#39;Y&#39;,)): {&#39;1&#39;: 4000},
 ((&#39;Yp&#39;,), (&#39;Z&#39;,)): {&#39;0&#39;: 1991, &#39;1&#39;: 2009}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Tomographic reconstruction</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">choi_lstsq</span> <span class="o">=</span> <span class="n">qpt_tomo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit time:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit fidelity (state):&#39;</span><span class="p">,</span> <span class="n">state_fidelity</span><span class="p">(</span><span class="n">choi_ideal</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">choi_lstsq</span><span class="o">.</span><span class="n">data</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit fidelity (process):&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">process_fidelity</span><span class="p">(</span><span class="n">choi_ideal</span><span class="p">,</span> <span class="n">choi_lstsq</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">require_cp</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FATAL: Cannot solve SDPs with &gt; 2x2 matrices without linked blas+lapack libraries
Install blas+lapack and re-compile SCS with blas+lapack library locations
ERROR: init_cone failure
Failure:could not initialize work
fit time: 0.07278251647949219
fit fidelity (state): 0.9958746339699709
fit fidelity (process): 0.9917662844081608
</pre></div></div>
</div>
</div>
<div class="section" id="1-qubit-process-tomography-of-two-qubit-swap-gate">
<h2>1-qubit process tomography of two-qubit swap gate<a class="headerlink" href="#1-qubit-process-tomography-of-two-qubit-swap-gate" title="Enlazar permanentemente con este título">¶</a></h2>
<p>We will prepare qubit-0 and measure qubit-1 so the reconstructed channel should be an identity.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Process tomography of a Hadamard gate</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Ideal channel is a unitary</span>
<span class="n">ideal_unitary</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">vector_ideal</span> <span class="o">=</span> <span class="n">ideal_unitary</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
<span class="n">choi_ideal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">vector_ideal</span><span class="p">,</span> <span class="n">vector_ideal</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span>

<span class="c1"># Generate process tomography circuits and run on qasm simulator</span>
<span class="c1"># We use the optional prepared_qubits kwarg to specify that the prepared qubit was different to measured qubit</span>
<span class="n">qpt_circs</span> <span class="o">=</span> <span class="n">process_tomography_circuits</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">prepared_qubits</span><span class="o">=</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">qpt_circs</span><span class="p">,</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>

<span class="c1"># Extract tomography data so that counts are indexed by measurement configuration</span>
<span class="n">qpt_tomo</span> <span class="o">=</span> <span class="n">ProcessTomographyFitter</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">qpt_circs</span><span class="p">)</span>
<span class="n">qpt_tomo</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{((&#39;Zp&#39;,), (&#39;X&#39;,)): {&#39;0&#39;: 966, &#39;1&#39;: 1034},
 ((&#39;Zp&#39;,), (&#39;Y&#39;,)): {&#39;0&#39;: 1023, &#39;1&#39;: 977},
 ((&#39;Zp&#39;,), (&#39;Z&#39;,)): {&#39;0&#39;: 2000},
 ((&#39;Zm&#39;,), (&#39;X&#39;,)): {&#39;0&#39;: 993, &#39;1&#39;: 1007},
 ((&#39;Zm&#39;,), (&#39;Y&#39;,)): {&#39;0&#39;: 1009, &#39;1&#39;: 991},
 ((&#39;Zm&#39;,), (&#39;Z&#39;,)): {&#39;1&#39;: 2000},
 ((&#39;Xp&#39;,), (&#39;X&#39;,)): {&#39;0&#39;: 2000},
 ((&#39;Xp&#39;,), (&#39;Y&#39;,)): {&#39;0&#39;: 994, &#39;1&#39;: 1006},
 ((&#39;Xp&#39;,), (&#39;Z&#39;,)): {&#39;0&#39;: 981, &#39;1&#39;: 1019},
 ((&#39;Yp&#39;,), (&#39;X&#39;,)): {&#39;0&#39;: 997, &#39;1&#39;: 1003},
 ((&#39;Yp&#39;,), (&#39;Y&#39;,)): {&#39;0&#39;: 2000},
 ((&#39;Yp&#39;,), (&#39;Z&#39;,)): {&#39;0&#39;: 1004, &#39;1&#39;: 996}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Tomographic reconstruction</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">choi</span> <span class="o">=</span> <span class="n">qpt_tomo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit time:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit fidelity (state):&#39;</span><span class="p">,</span> <span class="n">state_fidelity</span><span class="p">(</span><span class="n">choi_ideal</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">choi</span><span class="o">.</span><span class="n">data</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit fidelity (process):&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">process_fidelity</span><span class="p">(</span><span class="n">choi_ideal</span><span class="p">,</span> <span class="n">choi</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">require_cp</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
fit time: 0.003989458084106445
fit fidelity (state): 0.9931039890728947
fit fidelity (process): 0.9862555324154729
</pre></div></div>
</div>
</div>
<div class="section" id="Advances-examples">
<h2>Advances examples<a class="headerlink" href="#Advances-examples" title="Enlazar permanentemente con este título">¶</a></h2>
</div>
<div class="section" id="Generating-and-fitting-random-states">
<h2>Generating and fitting random states<a class="headerlink" href="#Generating-and-fitting-random-states" title="Enlazar permanentemente con este título">¶</a></h2>
<p>We now test the functions on the state generated by a circuit consisting of a layer of random single qubit unitaries u3.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">random_u3_tomo</span><span class="p">(</span><span class="n">nq</span><span class="p">,</span> <span class="n">shots</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">rand_angles</span><span class="p">():</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">nq</span><span class="p">)</span>
    <span class="n">circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nq</span><span class="p">):</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">u3</span><span class="p">(</span><span class="o">*</span><span class="n">rand_angles</span><span class="p">(),</span> <span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;statevector_simulator&#39;</span><span class="p">))</span>
    <span class="n">psi_rand</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_statevector</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>

    <span class="n">qst_circs</span> <span class="o">=</span> <span class="n">state_tomography_circuits</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">qst_circs</span><span class="p">,</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">),</span>
                         <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>
    <span class="n">tomo_data</span> <span class="o">=</span> <span class="n">StateTomographyFitter</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">qst_circs</span><span class="p">)</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">tomo_data</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;F fit =&#39;</span><span class="p">,</span> <span class="n">state_fidelity</span><span class="p">(</span><span class="n">psi_rand</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Random single-qubit unitaries: set </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
    <span class="n">random_u3_tomo</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Random single-qubit unitaries: set 0
F fit = 0.9912624488590052
Random single-qubit unitaries: set 1
F fit = 0.9955321652578383
Random single-qubit unitaries: set 2
F fit = 0.9955341807191802
Random single-qubit unitaries: set 3
F fit = 0.9961116923414528
Random single-qubit unitaries: set 4
F fit = 0.9915573599156398
</pre></div></div>
</div>
</div>
<div class="section" id="5-Qubit-Bell-State">
<h2>5-Qubit Bell State<a class="headerlink" href="#5-Qubit-Bell-State" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create a state preparation circuit</span>
<span class="n">q5</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">bell5</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">q5</span><span class="p">)</span>
<span class="n">bell5</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q5</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">bell5</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q5</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">q5</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Get ideal output state</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">bell5</span><span class="p">,</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;statevector_simulator&#39;</span><span class="p">))</span>
<span class="n">psi_bell5</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_statevector</span><span class="p">(</span><span class="n">bell5</span><span class="p">)</span>

<span class="c1"># Generate circuits and run on simulator</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">qst_bell5</span> <span class="o">=</span> <span class="n">state_tomography_circuits</span><span class="p">(</span><span class="n">bell5</span><span class="p">,</span> <span class="n">q5</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">qst_bell5</span><span class="p">,</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>

<span class="c1"># Extract tomography data so that counts are indexed by measurement configuration</span>
<span class="n">tomo_bell5</span> <span class="o">=</span> <span class="n">StateTomographyFitter</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">qst_bell5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time taken:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Time taken: 6.197464942932129
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">rho_bell5</span> <span class="o">=</span> <span class="n">tomo_bell5</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time taken:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fit Fidelity:&#39;</span><span class="p">,</span> <span class="n">state_fidelity</span><span class="p">(</span><span class="n">psi_bell5</span><span class="p">,</span> <span class="n">rho_bell5</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Time taken: 3.1012156009674072
Fit Fidelity: 0.9936014720187993
</pre></div></div>
</div>
</div>
<div class="section" id="2-Qubit-Conditional-State-Tomography">
<h2>2-Qubit Conditional State Tomography<a class="headerlink" href="#2-Qubit-Conditional-State-Tomography" title="Enlazar permanentemente con este título">¶</a></h2>
<p>In this example, we have a three-qubit system where one of the qubits will be an ancilla for performing state tomography, i.e. only perform tomography when the third qubit is in the state «1». The circuit is setup in such a way that after conditional tomography we will get a Bell state on the first two qubits.</p>
<p>First make a 3Q GHZ state with no classical measurements.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create the actual circuit</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ghz</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">q2</span><span class="p">)</span>
<span class="n">ghz</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ghz</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ghz</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ghz</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ghz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
         ┌───┐
q2029_0: ┤ H ├──■────────────
         └───┘┌─┴─┐
q2029_1: ─────┤ X ├──■───────
              └───┘┌─┴─┐┌───┐
q2029_2: ──────────┤ X ├┤ H ├
                   └───┘└───┘
</pre></div></div>
</div>
<p>Here we are going to generate and run the state tomography circuits. Only pass the registers we want to perform state tomography on. The code will generate a new classical register for only those measurements.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qst_ghz</span> <span class="o">=</span> <span class="n">state_tomography_circuits</span><span class="p">(</span><span class="n">ghz</span><span class="p">,</span> <span class="p">[</span><span class="n">q2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">q2</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qst_ghz</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
         ┌───┐                ░ ┌───┐┌─┐
q2029_0: ┤ H ├──■─────────────░─┤ H ├┤M├───
         └───┘┌─┴─┐           ░ ├───┤└╥┘┌─┐
q2029_1: ─────┤ X ├──■────────░─┤ H ├─╫─┤M├
              └───┘┌─┴─┐┌───┐ ░ └───┘ ║ └╥┘
q2029_2: ──────────┤ X ├┤ H ├─░───────╫──╫─
                   └───┘└───┘ ░       ║  ║
  c10: 2/═════════════════════════════╩══╩═
                                      0  1
</pre></div></div>
</div>
<p>Now make a copy of this circuit (we will need it for the fitter) and make a new circuit with an ancilla measurement attached (this is what will be run):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Make a copy without the ancilla register</span>
<span class="n">qst_ghz_no_anc</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">qst_ghz</span><span class="p">)</span>
<span class="n">ca</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">qst_ghz_circ</span> <span class="ow">in</span> <span class="n">qst_ghz</span><span class="p">:</span>
    <span class="n">qst_ghz_circ</span><span class="o">.</span><span class="n">add_register</span><span class="p">(</span><span class="n">ca</span><span class="p">)</span>
    <span class="n">qst_ghz_circ</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">ca</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Run in Aer</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">qst_ghz</span><span class="p">,</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">raw_results</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Before sending the results to the state tomography fitter we must strip the register for the Q2 measurement and only keep the results when that register is 1.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>

<span></span><span class="n">new_result</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">raw_results</span><span class="p">)</span>

<span class="k">for</span> <span class="n">resultidx</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">raw_results</span><span class="o">.</span><span class="n">results</span><span class="p">):</span>
    <span class="n">old_counts</span> <span class="o">=</span> <span class="n">raw_results</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">resultidx</span><span class="p">)</span>
    <span class="n">new_counts</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1">#change the size of the classical register</span>
    <span class="n">new_result</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">resultidx</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">creg_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_result</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">resultidx</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">creg_sizes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">new_result</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">resultidx</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">clbit_labels</span> <span class="o">=</span> <span class="n">new_result</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">resultidx</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">clbit_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">new_result</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">resultidx</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">memory_slots</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">for</span> <span class="n">reg_key</span> <span class="ow">in</span> <span class="n">old_counts</span><span class="p">:</span>
        <span class="n">reg_bits</span> <span class="o">=</span> <span class="n">reg_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reg_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="n">new_counts</span><span class="p">[</span><span class="n">reg_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="n">old_counts</span><span class="p">[</span><span class="n">reg_key</span><span class="p">]</span>

        <span class="n">new_result</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">resultidx</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">counts</span> <span class="o">=</span> <span class="n">new_counts</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tomo_bell</span> <span class="o">=</span> <span class="n">StateTomographyFitter</span><span class="p">(</span><span class="n">new_result</span><span class="p">,</span> <span class="n">qst_ghz_no_anc</span><span class="p">)</span>
<span class="c1"># Perform the tomography fit</span>
<span class="c1"># which outputs a density matrix</span>
<span class="n">rho_bell</span> <span class="o">=</span> <span class="n">tomo_bell</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">rho_bell</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0.5  +0.j   , -0.001-0.005j, -0.005+0.005j, -0.499-0.005j],
       [-0.001+0.005j,  0.   +0.j   , -0.   -0.j   ,  0.002-0.005j],
       [-0.005-0.005j, -0.   +0.j   ,  0.   +0.j   ,  0.004+0.005j],
       [-0.499+0.005j,  0.002+0.005j,  0.004-0.005j,  0.499+0.j   ]])
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Gate-set-tomography">
<h1>Gate set tomography<a class="headerlink" href="#Gate-set-tomography" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="1-Qubit-gate-set-tomography-Examples">
<h2>1-Qubit gate set tomography Examples<a class="headerlink" href="#1-Qubit-gate-set-tomography-Examples" title="Enlazar permanentemente con este título">¶</a></h2>
<p>The main difference between gate set tomography and process tomography is that in gate set tomography, the input consists of a gate set basis: A set of gates that are both used in the initialization/measurement phase of the tomography, and are being reconstructed.</p>
<p>Qiskit supplies a default gateset basis; in order to use this gateset basis in order to reconstruct another gate, this gate should be added to the basis. We use the following method to simplify the process:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.ignis.verification.tomography.basis</span> <span class="kn">import</span> <span class="n">default_gateset_basis</span>

<span class="k">def</span> <span class="nf">collect_tomography_data</span><span class="p">(</span><span class="n">shots</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                            <span class="n">noise_model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">gateset_basis</span><span class="o">=</span><span class="s1">&#39;Standard GST&#39;</span><span class="p">):</span>
    <span class="n">backend_qasm</span> <span class="o">=</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">)</span>
    <span class="n">circuits</span> <span class="o">=</span> <span class="n">gateset_tomography_circuits</span><span class="p">(</span><span class="n">gateset_basis</span><span class="o">=</span><span class="n">gateset_basis</span><span class="p">)</span>
    <span class="n">qobj</span> <span class="o">=</span> <span class="n">assemble</span><span class="p">(</span><span class="n">circuits</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">backend_qasm</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qobj</span><span class="p">,</span> <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
    <span class="n">fitter</span> <span class="o">=</span> <span class="n">GatesetTomographyFitter</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">circuits</span><span class="p">,</span> <span class="n">gateset_basis</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fitter</span>

<span class="k">def</span> <span class="nf">gate_set_tomography</span><span class="p">(</span><span class="n">gate</span><span class="p">,</span> <span class="n">noise_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="n">default_gateset_basis</span><span class="p">()</span>
    <span class="n">basis</span><span class="o">.</span><span class="n">add_gate</span><span class="p">(</span><span class="n">gate</span><span class="p">)</span>
    <span class="n">fitter</span> <span class="o">=</span> <span class="n">collect_tomography_data</span><span class="p">(</span><span class="n">shots</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span> <span class="n">gateset_basis</span><span class="o">=</span><span class="n">basis</span><span class="p">)</span>
    <span class="n">result_gates</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="n">result_gate</span> <span class="o">=</span> <span class="n">result_gates</span><span class="p">[</span><span class="n">gate</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Choi</span><span class="p">(</span><span class="n">result_gate</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Noiseless-1-qubit-gate-set-tomography">
<h3>Noiseless 1-qubit gate set tomography<a class="headerlink" href="#Noiseless-1-qubit-gate-set-tomography" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">choi_ideal</span> <span class="o">=</span> <span class="n">Choi</span><span class="p">(</span><span class="n">HGate</span><span class="p">())</span><span class="o">.</span><span class="n">data</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">choi</span> <span class="o">=</span> <span class="n">gate_set_tomography</span><span class="p">(</span><span class="n">HGate</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit time:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit fidelity (state):&#39;</span><span class="p">,</span> <span class="n">state_fidelity</span><span class="p">(</span><span class="n">choi_ideal</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">choi</span><span class="o">.</span><span class="n">data</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit fidelity (process):&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">process_fidelity</span><span class="p">(</span><span class="n">choi_ideal</span><span class="p">,</span> <span class="n">choi</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">require_cp</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
fit time: 2.4005630016326904
fit fidelity (state): 1.0040070587253802
fit fidelity (process): 1.0080301736826522
</pre></div></div>
</div>
</div>
<div class="section" id="1-qubit-gate-set-tomography-with-amplitude-damping-noise">
<h3>1-qubit gate set tomography with amplitude damping noise<a class="headerlink" href="#1-qubit-gate-set-tomography-with-amplitude-damping-noise" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Note that we add the noise to all gates (meaning also to the gates performing the tomography)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">A0</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">gamma</span><span class="p">)]]</span>
<span class="n">A1</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">)],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">noise_choi</span> <span class="o">=</span> <span class="n">Choi</span><span class="p">(</span><span class="n">Kraus</span><span class="p">([</span><span class="n">A0</span><span class="p">,</span> <span class="n">A1</span><span class="p">]))</span><span class="o">.</span><span class="n">data</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">QuantumError</span><span class="p">([([{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;kraus&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;qubits&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                         <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">A0</span><span class="p">,</span> <span class="n">A1</span><span class="p">]}],</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">noise_model</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">NoiseModel</span><span class="p">()</span>
<span class="n">noise_model</span><span class="o">.</span><span class="n">add_all_qubit_quantum_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;u1&#39;</span><span class="p">,</span> <span class="s1">&#39;u2&#39;</span><span class="p">,</span> <span class="s1">&#39;u3&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">choi_ideal</span> <span class="o">=</span> <span class="p">(</span><span class="n">Choi</span><span class="p">(</span><span class="n">XGate</span><span class="p">())</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">noise_choi</span><span class="p">))</span><span class="o">.</span><span class="n">data</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">choi</span> <span class="o">=</span> <span class="n">gate_set_tomography</span><span class="p">(</span><span class="n">XGate</span><span class="p">(),</span> <span class="n">noise_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit time:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit fidelity (state):&#39;</span><span class="p">,</span> <span class="n">state_fidelity</span><span class="p">(</span><span class="n">choi_ideal</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">choi</span><span class="o">.</span><span class="n">data</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit fidelity (process):&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">process_fidelity</span><span class="p">(</span><span class="n">choi_ideal</span><span class="p">,</span> <span class="n">choi</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">require_cp</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
fit time: 1.9352388381958008
fit fidelity (state): 0.9947735751075302
fit fidelity (process): 0.8362664609647777
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">qiskit.tools.jupyter</span>
<span class="o">%</span><span class="k">qiskit_version_table</span>
<span class="o">%</span><span class="k">qiskit_copyright</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<h3>Version Information</h3><table><tr><th>Qiskit Software</th><th>Version</th></tr><tr><td>Qiskit</td><td>0.20.0</td></tr><tr><td>Terra</td><td>0.15.1</td></tr><tr><td>Aer</td><td>0.6.1</td></tr><tr><td>Ignis</td><td>0.4.0</td></tr><tr><td>Aqua</td><td>0.7.5</td></tr><tr><td>IBM Q Provider</td><td>0.7.2</td></tr><tr><th>System information</th></tr><tr><td>Python</td><td>3.7.6 (default, Jan  8 2020, 20:23:39) [MSC v.1916 64 bit (AMD64)]</td></tr><tr><td>OS</td><td>Windows</td></tr><tr><td>CPUs</td><td>8</td></tr><tr><td>Memory (Gb)</td><td>31.853038787841797</td></tr><tr><td colspan='2'>Thu Aug 20 11:19:26 2020 Jerusalem Summer Time</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style='width: 100%; background-color:#d5d9e0;padding-left: 10px; padding-bottom: 10px; padding-right: 10px; padding-top: 5px'><h3>This code is a part of Qiskit</h3><p>&copy; Copyright IBM 2017, 2020.</p><p>This code is licensed under the Apache License, Version 2.0. You may<br>obtain a copy of this license in the LICENSE.txt file in the root directory<br> of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.<p>Any modifications or derivative works of this code must retain this<br>copyright notice, and modified files need to carry a notice indicating<br>that they have been altered from the originals.</p></div></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="9_entanglement_verification.html" class="btn btn-neutral float-right" title="Entanglement Verification" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="7_accreditation.html" class="btn btn-neutral float-left" title="Accreditation protocol" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Qiskit Development Team
      <span class="lastupdated">
        Actualizado por última vez en 2020/10/12.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Estás viendo</span>
    lang: es_ES
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    
    <dl>
      <dt>Idiomas</dt>
      
        <dd><a class="version" href="/documentation/tutorials/noise/8_tomography.html">English</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ja_JP/tutorials/noise/8_tomography.html">Japanese</a></dd>
      
        <dd><a class="version" href="/documentation/locale/de_DE/tutorials/noise/8_tomography.html">German</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ko_KR/tutorials/noise/8_tomography.html">Korean</a></dd>
      
    </dl>
    
  </div>
  <script>
    jQuery('.version').click((evt) => {
      const hash = window.location.hash
      const complete_url = evt.target.href + hash
      window.location = complete_url
      evt.preventDefault()
    })
  </script>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>