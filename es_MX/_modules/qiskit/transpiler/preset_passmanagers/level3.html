


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es-MX" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es-MX" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>qiskit.transpiler.preset_passmanagers.level3 &mdash; documentación de Qiskit - 0.23.0</title>
  

  
  
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme-override.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/panels-variables.ade9f9d55df9d2893fc676ecd59723a1.css" type="text/css" />
    <link rel="index" title="Índice" href="../../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../../search.html" /> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://qiskit.org/learn" target="_blank">Learning Resources</a>
          </li>

          <li>
            <a href="https://qiskit.slack.com" target="_blank">Slack Support</a>
          </li>

          <li>
            <a href="https://quantum-computing.ibm.com/" target="_blank">IBM Quantum Experience</a>
          </li>

          <li>
            <a href="https://github.com/Qiskit/" target="_blank">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../install.html">Instalación de Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started.html">Primeros Pasos con Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../the_elements.html">Los Elementos de Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../development_strategy.html">Development Strategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing_to_qiskit.html">Contribuir a Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../configuration.html">Local Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq.html">Preguntas frecuentes</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutoriales</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/circuits/index.html">Circuitos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/circuits_advanced/index.html">Circuitos Avanzados</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/pulse/index.html">Pulso</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/simulators/index.html">Simuladores de Alto Desempeño</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/noise/index.html">Análisis de Error en Sistemas Cuánticos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/optimization/index.html">Optimización</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/finance/index.html">Finanzas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/chemistry/index.html">Química</a></li>
</ul>
<p class="caption"><span class="caption-text">Bibliotecas</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../apidoc/circuit_library.html">Biblioteca de Circuitos</a></li>
</ul>
<p class="caption"><span class="caption-text">Referencia de la API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../apidoc/terra.html">Qiskit Terra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../apidoc/aer.html">Qiskit Aer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../apidoc/ignis.html">Qiskit Ignis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../apidoc/aqua.html">Qiskit Aqua</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../apidoc/ibmq-provider.html">Proveedor Cuántico IBM Qiskit</a></li>
</ul>
<p class="caption"><span class="caption-text">Solución de Problemas</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://quantum-computing.ibm.com/docs/cloud/errors">Códigos de Error de la Quantum Experience API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="../../../index.html">Código de módulo</a> &gt;</li>
        
      <li>qiskit.transpiler.preset_passmanagers.level3</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <h1>Código fuente para qiskit.transpiler.preset_passmanagers.level3</h1><div class="highlight"><pre>
<span></span><span class="c1"># This code is part of Qiskit.</span>
<span class="c1">#</span>
<span class="c1"># (C) Copyright IBM 2017, 2018.</span>
<span class="c1">#</span>
<span class="c1"># This code is licensed under the Apache License, Version 2.0. You may</span>
<span class="c1"># obtain a copy of this license in the LICENSE.txt file in the root directory</span>
<span class="c1"># of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.</span>
<span class="c1">#</span>
<span class="c1"># Any modifications or derivative works of this code must retain this</span>
<span class="c1"># copyright notice, and modified files need to carry a notice indicating</span>
<span class="c1"># that they have been altered from the originals.</span>

<span class="sd">&quot;&quot;&quot;Pass manager for optimization level 3, providing heavy optimization.</span>

<span class="sd">Level 3 pass manager: heavy optimization by noise adaptive qubit mapping and</span>
<span class="sd">gate cancellation using commutativity rules and unitary synthesis.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">from</span> <span class="nn">qiskit.transpiler.passmanager_config</span> <span class="kn">import</span> <span class="n">PassManagerConfig</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passmanager</span> <span class="kn">import</span> <span class="n">PassManager</span>

<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">Unroller</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">BasisTranslator</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">UnrollCustomDefinitions</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">Unroll3qOrMore</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">CheckMap</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">CXDirection</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">SetLayout</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">CSPLayout</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">TrivialLayout</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">DenseLayout</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">NoiseAdaptiveLayout</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">SabreLayout</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">BarrierBeforeFinalMeasurements</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">BasicSwap</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">LookaheadSwap</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">StochasticSwap</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">SabreSwap</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">FullAncillaAllocation</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">EnlargeWithAncilla</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">FixedPoint</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">Depth</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">RemoveResetInZeroState</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">Optimize1qGates</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">Optimize1qGatesDecomposition</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">CommutativeCancellation</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">OptimizeSwapBeforeMeasure</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">RemoveDiagonalGatesBeforeMeasure</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">Collect2qBlocks</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">ConsolidateBlocks</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">UnitarySynthesis</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">ApplyLayout</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">CheckCXDirection</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">TimeUnitAnalysis</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">ALAPSchedule</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="n">ASAPSchedule</span>

<span class="kn">from</span> <span class="nn">qiskit.transpiler</span> <span class="kn">import</span> <span class="n">TranspilerError</span>


<div class="viewcode-block" id="level_3_pass_manager"><a class="viewcode-back" href="../../../../stubs/qiskit.transpiler.preset_passmanagers.level_3_pass_manager.html#qiskit.transpiler.preset_passmanagers.level_3_pass_manager">[documentos]</a><span class="k">def</span> <span class="nf">level_3_pass_manager</span><span class="p">(</span><span class="n">pass_manager_config</span><span class="p">:</span> <span class="n">PassManagerConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PassManager</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Level 3 pass manager: heavy optimization by noise adaptive qubit mapping and</span>
<span class="sd">    gate cancellation using commutativity rules and unitary synthesis.</span>

<span class="sd">    This pass manager applies the user-given initial layout. If none is given, a search</span>
<span class="sd">    for a perfect layout (i.e. one that satisfies all 2-qubit interactions) is conducted.</span>
<span class="sd">    If no such layout is found, and device calibration information is available, the</span>
<span class="sd">    circuit is mapped to the qubits with best readouts and to CX gates with highest fidelity.</span>

<span class="sd">    The pass manager then transforms the circuit to match the coupling constraints.</span>
<span class="sd">    It is then unrolled to the basis, and any flipped cx directions are fixed.</span>
<span class="sd">    Finally, optimizations in the form of commutative gate cancellation, resynthesis</span>
<span class="sd">    of two-qubit unitary blocks, and redundant reset removal are performed.</span>

<span class="sd">    Note:</span>
<span class="sd">        In simulators where ``coupling_map=None``, only the unrolling and</span>
<span class="sd">        optimization stages are done.</span>

<span class="sd">    Args:</span>
<span class="sd">        pass_manager_config: configuration of the pass manager.</span>

<span class="sd">    Returns:</span>
<span class="sd">        a level 3 pass manager.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TranspilerError: if the passmanager config is invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basis_gates</span> <span class="o">=</span> <span class="n">pass_manager_config</span><span class="o">.</span><span class="n">basis_gates</span>
    <span class="n">coupling_map</span> <span class="o">=</span> <span class="n">pass_manager_config</span><span class="o">.</span><span class="n">coupling_map</span>
    <span class="n">initial_layout</span> <span class="o">=</span> <span class="n">pass_manager_config</span><span class="o">.</span><span class="n">initial_layout</span>
    <span class="n">layout_method</span> <span class="o">=</span> <span class="n">pass_manager_config</span><span class="o">.</span><span class="n">layout_method</span> <span class="ow">or</span> <span class="s1">&#39;dense&#39;</span>
    <span class="n">routing_method</span> <span class="o">=</span> <span class="n">pass_manager_config</span><span class="o">.</span><span class="n">routing_method</span> <span class="ow">or</span> <span class="s1">&#39;stochastic&#39;</span>
    <span class="n">translation_method</span> <span class="o">=</span> <span class="n">pass_manager_config</span><span class="o">.</span><span class="n">translation_method</span> <span class="ow">or</span> <span class="s1">&#39;translator&#39;</span>
    <span class="n">scheduling_method</span> <span class="o">=</span> <span class="n">pass_manager_config</span><span class="o">.</span><span class="n">scheduling_method</span>
    <span class="n">instruction_durations</span> <span class="o">=</span> <span class="n">pass_manager_config</span><span class="o">.</span><span class="n">instruction_durations</span>
    <span class="n">seed_transpiler</span> <span class="o">=</span> <span class="n">pass_manager_config</span><span class="o">.</span><span class="n">seed_transpiler</span>
    <span class="n">backend_properties</span> <span class="o">=</span> <span class="n">pass_manager_config</span><span class="o">.</span><span class="n">backend_properties</span>

    <span class="c1"># 1. Unroll to 1q or 2q gates</span>
    <span class="n">_unroll3q</span> <span class="o">=</span> <span class="n">Unroll3qOrMore</span><span class="p">()</span>

    <span class="c1"># 2. Layout on good qubits if calibration info available, otherwise on dense links</span>
    <span class="n">_given_layout</span> <span class="o">=</span> <span class="n">SetLayout</span><span class="p">(</span><span class="n">initial_layout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_choose_layout_condition</span><span class="p">(</span><span class="n">property_set</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">property_set</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">]</span>

    <span class="n">_choose_layout_1</span> <span class="o">=</span> <span class="n">CSPLayout</span><span class="p">(</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">call_limit</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">layout_method</span> <span class="o">==</span> <span class="s1">&#39;trivial&#39;</span><span class="p">:</span>
        <span class="n">_choose_layout_2</span> <span class="o">=</span> <span class="n">TrivialLayout</span><span class="p">(</span><span class="n">coupling_map</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">layout_method</span> <span class="o">==</span> <span class="s1">&#39;dense&#39;</span><span class="p">:</span>
        <span class="n">_choose_layout_2</span> <span class="o">=</span> <span class="n">DenseLayout</span><span class="p">(</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">backend_properties</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">layout_method</span> <span class="o">==</span> <span class="s1">&#39;noise_adaptive&#39;</span><span class="p">:</span>
        <span class="n">_choose_layout_2</span> <span class="o">=</span> <span class="n">NoiseAdaptiveLayout</span><span class="p">(</span><span class="n">backend_properties</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">layout_method</span> <span class="o">==</span> <span class="s1">&#39;sabre&#39;</span><span class="p">:</span>
        <span class="n">_choose_layout_2</span> <span class="o">=</span> <span class="n">SabreLayout</span><span class="p">(</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">max_iterations</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed_transpiler</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TranspilerError</span><span class="p">(</span><span class="s2">&quot;Invalid layout method </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">layout_method</span><span class="p">)</span>

    <span class="c1"># 3. Extend dag/layout with ancillas using the full coupling map</span>
    <span class="n">_embed</span> <span class="o">=</span> <span class="p">[</span><span class="n">FullAncillaAllocation</span><span class="p">(</span><span class="n">coupling_map</span><span class="p">),</span> <span class="n">EnlargeWithAncilla</span><span class="p">(),</span> <span class="n">ApplyLayout</span><span class="p">()]</span>

    <span class="c1"># 4. Swap to fit the coupling map</span>
    <span class="n">_swap_check</span> <span class="o">=</span> <span class="n">CheckMap</span><span class="p">(</span><span class="n">coupling_map</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_swap_condition</span><span class="p">(</span><span class="n">property_set</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">property_set</span><span class="p">[</span><span class="s1">&#39;is_swap_mapped&#39;</span><span class="p">]</span>

    <span class="n">_swap</span> <span class="o">=</span> <span class="p">[</span><span class="n">BarrierBeforeFinalMeasurements</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">routing_method</span> <span class="o">==</span> <span class="s1">&#39;basic&#39;</span><span class="p">:</span>
        <span class="n">_swap</span> <span class="o">+=</span> <span class="p">[</span><span class="n">BasicSwap</span><span class="p">(</span><span class="n">coupling_map</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="n">routing_method</span> <span class="o">==</span> <span class="s1">&#39;stochastic&#39;</span><span class="p">:</span>
        <span class="n">_swap</span> <span class="o">+=</span> <span class="p">[</span><span class="n">StochasticSwap</span><span class="p">(</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed_transpiler</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="n">routing_method</span> <span class="o">==</span> <span class="s1">&#39;lookahead&#39;</span><span class="p">:</span>
        <span class="n">_swap</span> <span class="o">+=</span> <span class="p">[</span><span class="n">LookaheadSwap</span><span class="p">(</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">search_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">search_width</span><span class="o">=</span><span class="mi">6</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="n">routing_method</span> <span class="o">==</span> <span class="s1">&#39;sabre&#39;</span><span class="p">:</span>
        <span class="n">_swap</span> <span class="o">+=</span> <span class="p">[</span><span class="n">SabreSwap</span><span class="p">(</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">heuristic</span><span class="o">=</span><span class="s1">&#39;decay&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed_transpiler</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TranspilerError</span><span class="p">(</span><span class="s2">&quot;Invalid routing method </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">routing_method</span><span class="p">)</span>

    <span class="c1"># 5. Unroll to the basis</span>
    <span class="k">if</span> <span class="n">translation_method</span> <span class="o">==</span> <span class="s1">&#39;unroller&#39;</span><span class="p">:</span>
        <span class="n">_unroll</span> <span class="o">=</span> <span class="p">[</span><span class="n">Unroller</span><span class="p">(</span><span class="n">basis_gates</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="n">translation_method</span> <span class="o">==</span> <span class="s1">&#39;translator&#39;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">qiskit.circuit.equivalence_library</span> <span class="kn">import</span> <span class="n">SessionEquivalenceLibrary</span> <span class="k">as</span> <span class="n">sel</span>
        <span class="n">_unroll</span> <span class="o">=</span> <span class="p">[</span><span class="n">UnrollCustomDefinitions</span><span class="p">(</span><span class="n">sel</span><span class="p">,</span> <span class="n">basis_gates</span><span class="p">),</span>
                   <span class="n">BasisTranslator</span><span class="p">(</span><span class="n">sel</span><span class="p">,</span> <span class="n">basis_gates</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="n">translation_method</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span><span class="p">:</span>
        <span class="n">_unroll</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Unroll3qOrMore</span><span class="p">(),</span>
            <span class="n">Collect2qBlocks</span><span class="p">(),</span>
            <span class="n">ConsolidateBlocks</span><span class="p">(</span><span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">),</span>
            <span class="n">UnitarySynthesis</span><span class="p">(</span><span class="n">basis_gates</span><span class="p">),</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TranspilerError</span><span class="p">(</span><span class="s2">&quot;Invalid translation method </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">translation_method</span><span class="p">)</span>

    <span class="c1"># 6. Fix any CX direction mismatch</span>
    <span class="n">_direction_check</span> <span class="o">=</span> <span class="p">[</span><span class="n">CheckCXDirection</span><span class="p">(</span><span class="n">coupling_map</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">_direction_condition</span><span class="p">(</span><span class="n">property_set</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">property_set</span><span class="p">[</span><span class="s1">&#39;is_direction_mapped&#39;</span><span class="p">]</span>

    <span class="n">_direction</span> <span class="o">=</span> <span class="p">[</span><span class="n">CXDirection</span><span class="p">(</span><span class="n">coupling_map</span><span class="p">)]</span>

    <span class="c1"># 8. Optimize iteratively until no more change in depth. Removes useless gates</span>
    <span class="c1"># after reset and before measure, commutes gates and optimizes continguous blocks.</span>
    <span class="n">_depth_check</span> <span class="o">=</span> <span class="p">[</span><span class="n">Depth</span><span class="p">(),</span> <span class="n">FixedPoint</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">_opt_control</span><span class="p">(</span><span class="n">property_set</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">property_set</span><span class="p">[</span><span class="s1">&#39;depth_fixed_point&#39;</span><span class="p">]</span>

    <span class="n">_reset</span> <span class="o">=</span> <span class="p">[</span><span class="n">RemoveResetInZeroState</span><span class="p">()]</span>

    <span class="n">_meas</span> <span class="o">=</span> <span class="p">[</span><span class="n">OptimizeSwapBeforeMeasure</span><span class="p">(),</span> <span class="n">RemoveDiagonalGatesBeforeMeasure</span><span class="p">()]</span>

    <span class="k">if</span> <span class="n">basis_gates</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;u1&#39;</span> <span class="ow">in</span> <span class="n">basis_gates</span> <span class="ow">or</span> <span class="s1">&#39;u2&#39;</span> <span class="ow">in</span> <span class="n">basis_gates</span> <span class="ow">or</span>
                        <span class="s1">&#39;u3&#39;</span> <span class="ow">in</span> <span class="n">basis_gates</span><span class="p">):</span>
        <span class="n">_opt</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Collect2qBlocks</span><span class="p">(),</span>
            <span class="n">ConsolidateBlocks</span><span class="p">(</span><span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">),</span>
            <span class="n">UnitarySynthesis</span><span class="p">(</span><span class="n">basis_gates</span><span class="p">),</span>
            <span class="n">Optimize1qGates</span><span class="p">(</span><span class="n">basis_gates</span><span class="p">),</span>
            <span class="n">CommutativeCancellation</span><span class="p">(),</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_opt</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Collect2qBlocks</span><span class="p">(),</span>
            <span class="n">ConsolidateBlocks</span><span class="p">(</span><span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">),</span>
            <span class="n">UnitarySynthesis</span><span class="p">(</span><span class="n">basis_gates</span><span class="p">),</span>
            <span class="n">Optimize1qGatesDecomposition</span><span class="p">(</span><span class="n">basis_gates</span><span class="p">),</span>
            <span class="n">CommutativeCancellation</span><span class="p">(),</span>
        <span class="p">]</span>

    <span class="c1"># Schedule the circuit only when scheduling_method is supplied</span>
    <span class="k">if</span> <span class="n">scheduling_method</span><span class="p">:</span>
        <span class="n">_scheduling</span> <span class="o">=</span> <span class="p">[</span><span class="n">TimeUnitAnalysis</span><span class="p">(</span><span class="n">instruction_durations</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">scheduling_method</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;alap&#39;</span><span class="p">,</span> <span class="s1">&#39;as_late_as_possible&#39;</span><span class="p">}:</span>
            <span class="n">_scheduling</span> <span class="o">+=</span> <span class="p">[</span><span class="n">ALAPSchedule</span><span class="p">(</span><span class="n">instruction_durations</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">scheduling_method</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;asap&#39;</span><span class="p">,</span> <span class="s1">&#39;as_soon_as_possible&#39;</span><span class="p">}:</span>
            <span class="n">_scheduling</span> <span class="o">+=</span> <span class="p">[</span><span class="n">ASAPSchedule</span><span class="p">(</span><span class="n">instruction_durations</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TranspilerError</span><span class="p">(</span><span class="s2">&quot;Invalid scheduling method </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">scheduling_method</span><span class="p">)</span>

    <span class="c1"># Build pass manager</span>
    <span class="n">pm3</span> <span class="o">=</span> <span class="n">PassManager</span><span class="p">()</span>
    <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_unroll3q</span><span class="p">)</span>
    <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_reset</span> <span class="o">+</span> <span class="n">_meas</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">coupling_map</span><span class="p">:</span>
        <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_given_layout</span><span class="p">)</span>
        <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_choose_layout_1</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="n">_choose_layout_condition</span><span class="p">)</span>
        <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_choose_layout_2</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="n">_choose_layout_condition</span><span class="p">)</span>
        <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_embed</span><span class="p">)</span>
        <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_swap_check</span><span class="p">)</span>
        <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_swap</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="n">_swap_condition</span><span class="p">)</span>
    <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_unroll</span><span class="p">)</span>
    <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_depth_check</span> <span class="o">+</span> <span class="n">_opt</span> <span class="o">+</span> <span class="n">_unroll</span><span class="p">,</span> <span class="n">do_while</span><span class="o">=</span><span class="n">_opt_control</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">coupling_map</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">coupling_map</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">:</span>
        <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_direction_check</span><span class="p">)</span>
        <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_direction</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="n">_direction_condition</span><span class="p">)</span>
    <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_reset</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">scheduling_method</span><span class="p">:</span>
        <span class="n">pm3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_scheduling</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pm3</span></div>
</pre></div>

             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Qiskit Development Team.
      Actualizado por última vez en 2020/11/10.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              
            </div>
          </div>
        </div>
      </section>
    </div>

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Estás viendo</span>
    lang: es_MX
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    
    <dl>
      <dt>Idiomas</dt>
      
        <dd><a class="version" href="/documentation/_modules/qiskit/transpiler/preset_passmanagers/level3.html">English</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ja_JP/_modules/qiskit/transpiler/preset_passmanagers/level3.html">Japanese</a></dd>
      
        <dd><a class="version" href="/documentation/locale/de_DE/_modules/qiskit/transpiler/preset_passmanagers/level3.html">German</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ko_KR/_modules/qiskit/transpiler/preset_passmanagers/level3.html">Korean</a></dd>
      
    </dl>
    
  </div>
  <script>
    jQuery('.version').click((evt) => {
      const hash = window.location.hash
      const complete_url = evt.target.href + hash
      window.location = complete_url
      evt.preventDefault()
    })
  </script>
</div>

  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
         <script src="../../../../_static/jquery.js"></script>
         <script src="../../../../_static/underscore.js"></script>
         <script src="../../../../_static/doctools.js"></script>
         <script src="../../../../_static/language_data.js"></script>
         <script src="../../../../_static/thebelab-helper.js"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0-alpha.0/dist/embed-amd.js"></script>
         <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
         <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
     

  

  <script type="text/javascript" src="../../../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

<div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../../../../_static/images/pytorch-x.svg">
  </div>
</div>

  <div>
    <br>
  </div>

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://qiskit.org/learn" target="_blank">Learning Resources</a>
          </li>

          <li>
            <a href="https://qiskit.slack.com" target="_blank">Slack Support</a>
          </li>

          <li>
            <a href="https://quantum-computing.ibm.com/" target="_blank">IBM Quantum Experience</a>
          </li>

          <li>
            <a href="https://github.com/Qiskit/" target="_blank">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>